/* The smoothest fonts folks

*, html, body {
    font-family: "Segoe UI Variable Display";
    font-size: 12px;
    font-weight: 400 !important;
  text-rendering: optimizelegibility !important;
	font-smooth: always !important;
  -webkit-font-smoothing: antialiased !important;
}

*/

/* Disabled add search engine context menu item */
.menuitem-iconic.context-menu-add-engine,
.menuseparator-add-engine {
    display: none !important;
}

/* Disabled strip on share context menu item */
#strip-on-share {
    display: none !important;
}

/* Hide Search with Google or enter address in url bar */
#urlbar-input::placeholder {
    opacity: 0 !important;
}

#allTabsMenu-syncedTabs {
  display: none !important;
}
  
/* Hide All Tabs Button at top in tab bar
#alltabs-button {
    min-width: 14px !important;
    max-width: 14px !important;
    visibility: hidden !important;
}*/

/* Colors the URL bar on mouseover 
#urlbar-input-container:not([selected=true]):not([multiselected=true]):hover, #searchbox {
    background-color: color-mix(in srgb, currentColor 12%, transparent) !important;
} */

/* Hide Various other context menu items that are stupid */
#context-sendpagetodevice,
#context-sep-sendpagetodevice,
#context-sendlinktodevice,
#context-sep-sendlinktodevice,
#context_sendTabToDevice,
#context_sendTabToDevice_separator,
#context-stripOnShareLink {
    display: none !important;
}

#context-navigation > .menuitem-iconic {
  & > .menu-icon {
    padding: 0px !important;
  }
}

#context-back {
  --menuitem-icon: none !important;
}

#context-forward {
  --menuitem-icon: none !important;
}

#context-reload {
  --menuitem-icon: none !important;
}

#context-stop {
  --menuitem-icon: none !important;
}

/* Remove "Private Browsing Mode" text on top bar */
#private-browsing-indicator-with-label > label {
	display: none !important;
}

/* Remove "Share" from tab context menu */
#tabContextMenu .share-tab-url-item {
    display: none !important;
}

/* Delete "Email Image" in right click context menu */
#context-sendimage {
    display: none !important;
}

/* Disable navigation buttons on right click of page */
#context-back image,
#context-forward image,
#context-reload image,
#context-stop image,
#context-bookmarkpage image,
#context-navigation {
    display: none !important;
}

#placesContext_openSeparator {
  display: none !important;
 }


/* Make background tabs not as vibrant as selected tab
.tabbrowser-tab:not([selected=true]):not([multiselected=true]) .tab-background {
    background-color: color-mix(in srgb, currentColor 4%, transparent);
} */

/* Adjust the new tab button positioning to be more even */
#tabs-newtab-button, #TabsToolbar #new-tab-button {
    margin-inline-start: -2px !important;
}

/* Make unselected tabs foreground color a little less bright */
.tabbrowser-tab:not([selected]) .tab-content {
      color: var(--md-text-primary) !important;
}

/* Make Selected tab brighter */
.tabbrowser-tab[selected] .tab-content {
  color: var(--md-tab-label-color) !important;
}

#tabbrowser-arrowscrollbox {
  #navigator-toolbox:not(:hover) &:not([highlight])::part(scrollbutton-down) {
    transition: none !important;
  }
}

/* Tab close button the accent'ish color
.tab-close-button {
  -moz-context-properties: fill, fill-opacity;
  fill: var(--md-accent-color) !important;
}*/

#tabbrowser-tabs:not([noshadowfortests]) .tab-background:is([selected], [multiselected]) {
  box-shadow: unset !important;
  filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.45));
}


/* Make unselected tab title color on hover the selected tab color 
.tabbrowser-tab:hover:not([visuallyselected],[multiselected]) .tab-content
{
    color: color-mix(in srgb, currentColor 65%, transparent) !important;
}*/

/* Remove Ugly yellow dotted selection from Library Pane */
:root {
    --default-focusring-width: 0px !important;
    --sidebar-border-color: var(--md-menu-border-color) !important;
    --default-focusring: var(--default-focusring-width) solid !important;
    --arrowpanel-border-radius: 8px !important;
    --arrowpanel-menuitem-border-radius: 4px !important;
    --arrowpanel-color: var(--md-tab-label-color) !important;
    --arrowpanel-background: var(--md-menu-background-color) !important;
    --button-active-bgcolor: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
    --button-background-color-active: light-dark(color-mix(in srgb, AccentColor 86%, white), color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white)) !important;
    --toolbarbutton-active-background: var(--md-selection-background-color) !important;
    --toolbarbutton-border-radius: 4px !important;
    --urlbar-box-bgcolor: var(--md-background-color-100) !important;
    --message-bar-border-radius: 8px !important;
    --message-bar-border-width: 1px !important;
    --panel-subview-body-padding-block: 4px !important;
    --arrowpanel-menuitem-margin-inline: 4px !important;
    /*--arrowpanel-header-min-height: 0px !important; */
    /* --panel-separator-padding: 0px !important; */
    --button-background-color-ghost-hover: var(--md-menu-background-color-hover) !important;
    --toolbarbutton-hover-background: var(--md-menu-background-color-hover) !important;
    --tabpanel-background-color: var(--md-background-color-50) !important;
}

body {
    --arrowpanel-color: var(--md-tab-label-color) !important;
    --tabpanel-background-color: var(--md-background-color-50) !important;
}

panel {
  --arrowpanel-header-min-height: calc(var(--arrowpanel-header-back-icon-full-width) + (var(--panel-separator-margin-horizontal))) !important;
}

panel#appMenu-popup {
  --arrowpanel-header-min-height: calc(var(--arrowpanel-header-back-icon-full-width) + (var(--panel-separator-margin-horizontal) - 4)) !important;
}

@media (-moz-platform: windows) {
  #placesContext :is(menuitem, menu):not([image], .menu-iconic, .menuitem-iconic) {
    padding-inline-start: 12px !important;
  }

  #toolbar-context-menu :is(menuitem):not(.menu-iconic, .menuitem-iconic) {
    padding-inline-start: 36px !important;
  }
  
  /* Radio buttons always use 12px (like Always Show, Never Show) */
  #toolbar-context-menu menuitem[type="radio"] {
    padding-inline-start: 12px !important;
  }
  
  /* Checkbox items without icons use 12px */
  #toolbar-context-menu menuitem[type="checkbox"]:not(:has(.menu-icon)),
  #toolbar-context-menu menuitem[checked]:not([type]):not(:has(.menu-icon)) {
    padding-inline-start: 12px !important;
  }
  
  /* Checkbox items WITH icons - unchecked use 36px, checked use 12px */
  #toolbar-context-menu menuitem[type="checkbox"]:has(.menu-icon):not([checked="true"]) {
    padding-inline-start: 36px !important;
  }
  
  #toolbar-context-menu menuitem[type="checkbox"]:has(.menu-icon)[checked="true"] {
    padding-inline-start: 12px !important;
  }
}

@media (-moz-platform: windows) {
  /* Force small padding for all non-checkbox/radio items (including those with icons) */
  #toolbar-context-manage-extensions menuitem:not([type="checkbox"], [type="radio"], [checked]) {
    padding-inline-start: 12px !important;
  }

  /* Plain menuitems without icons - optional larger indent if desired (for alignment if no gutter needed) */
  /* Comment out or remove if you prefer uniform small padding */
  /*
  #toolbar-context-manage-extensions menuitem:not(:has(.menu-icon), [type="checkbox"], [type="radio"], [checked]) {
    padding-inline-start: 36px !important;
  }
  */

  /* Radio buttons always small padding */
  #toolbar-context-manage-extensions menuitem[type="radio"] {
    padding-inline-start: 12px !important;
  }

  /* Checkbox items without icons */
  #toolbar-context-manage-extensions menuitem[type="checkbox"]:not(:has(.menu-icon)) {
    padding-inline-start: 12px !important;
  }

  /* Checked items without type (some toggles) and without icons */
  #toolbar-context-manage-extensions menuitem[checked]:not([type]):not(:has(.menu-icon)) {
    padding-inline-start: 12px !important;
  }

  /* Checkbox items WITH icons - unchecked: larger padding, checked: small */
  #toolbar-context-manage-extensions menuitem[type="checkbox"]:has(.menu-icon):not([checked="true"]) {
    padding-inline-start: 36px !important;
  }

  #toolbar-context-manage-extensions menuitem[type="checkbox"]:has(.menu-icon)[checked="true"] {
    padding-inline-start: 12px !important;
  }
}

@media (-moz-platform: windows) {
  /* Plain menuitems (no icon, no checkbox/radio) - indent more for alignment */
  #toolbar-context-move-to-panel menuitem:not(:has(.menu-icon), [type="checkbox"], [type="radio"], [checked]) {
    padding-inline-start: 36px !important;
  }

  /* Radio buttons always small padding */
  #toolbar-context-move-to-panel menuitem[type="radio"] {
    padding-inline-start: 12px !important;
  }

  /* Checkbox items without icons */
  #toolbar-context-move-to-panel menuitem[type="checkbox"]:not(:has(.menu-icon)) {
    padding-inline-start: 12px !important;
  }

  /* Checked items without type (some toggles) and without icons */
  #toolbar-context-move-to-panel menuitem[checked]:not([type]):not(:has(.menu-icon)) {
    padding-inline-start: 12px !important;
  }

  /* Checkbox items WITH icons - unchecked: more padding, checked: small */
  #toolbar-context-move-to-panel menuitem[type="checkbox"]:has(.menu-icon):not([checked="true"]) {
    padding-inline-start: 36px !important;
  }

  #toolbar-context-move-to-panel menuitem[type="checkbox"]:has(.menu-icon)[checked="true"] {
    padding-inline-start: 12px !important;
  }
}


@media (-moz-platform: windows), (-moz-platform: linux) {
    .menupopup-arrowscrollbox {
        margin: var(--panel-shadow-margin) 20px 20px 20px !important;
        border: var(--md-menu-border-size) !important;
        border-color: var(--md-menu-border-color) !important;
        background: light-dark(Menu, var(--md-menu-background-color)) !important;
    }
}

  [part="content"] {
    border-width: unset !important;
    border: var(--md-menu-border-size) var(--md-menu-border-color) !important;
  }


@media (-moz-platform: windows), (-moz-platform: linux) {
  menu:where([_moz-menuactive="true"]):not([disabled="true"]), menuitem:where([_moz-menuactive="true"]):not([disabled="true"]) {
    color: var(--md-tab-label-color) !important;
  }
}

/* Coloring some of the tooltips */
tooltip {
    appearance: none !important;
    -moz-appearance: none !important;
    border-radius: 4px !important;
    border: var(--md-menu-border-size) !important;
    background-color: var(--md-background-color-0) !important;
    border-color: var(--md-menu-border-color) !important;
    color: var(--md-text-primary) !important;
    padding: 6px !important;
}

/* Styling the bottom left mouseover URL hover/loading thing */
#statuspanel-label {
    color: var(--md-text-primary) !important;
    background-color: var(--md-background-color-50) !important;
    border-left: none !important;
    @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
      border-right: var(--md-menu-border-size) !important;
      border-top: var(--md-menu-border-size) !important;
      border-color: var(--md-menu-border-color) !important;
    }
    @media (-moz-pref("userChrome.ui-chrome-refresh")) {
      border-color: transparent !important;
    }
    @media (-moz-pref("userChrome.ui-rounded-corners")) {
      border-color: transparent !important;
    }    
    border-bottom: none !important;
    border-radius: 0px 4px 0px 0px !important;
    padding: 4px !important;
}

/* Change height of bookmark bar */
:root,
#PersonalToolbar {
  --bookmarks-toolbar-overlapping-browser-heigh: max(30px, 2em) !important;
}

:root[BookmarksToolbarOverlapsBrowser] #PersonalToolbar {
    height: var(--bookmarks-toolbar-overlapping-browser-heigh) !important;
}

#PlacesToolbar,
#PlacesToolbarItems {
  align-items: center !important;
  height: 30px !important;
  margin-bottom: 2px !important;
  margin-top: 0px !important;
}
/*
#PlacesToolbar menuitem:hover, .menu-iconic.bookmark-item:hover {
    background-color: red !important;
}*/

/* Make URL bar fade in and out on mouse hover like Chrome */
.urlbar-background, #searchbar {
    background-color: var(--md-background-color-50) !important;
    transition: background-color 320ms cubic-bezier(0, 0, .2, 1) !important; /* Add a transition effect */
	  /*transition-timing-function: linear, cubic-bezier(0, 0, .2, 1), linear !important; */
    border: 1px solid var(--md-content-separator-color) !important;
    @media (-moz-pref("userChrome.ui-chrome-refresh")) {
      border: 0px solid transparent !important;
      }
    transition-delay: 25ms !important;
}

#urlbar:not([focused]):hover .urlbar-background, #searchbar:hover {
    background-color: color-mix(in srgb, var(--md-background-color-50) 61%, var(--md-background-color-100)) !important;
}

#urlbar[focused]:not([suppress-focus-border]) > .urlbar-background, #searchbar:focus {
  box-shadow: 0 1px 5px #00000054 !important;
}

@keyframes urlbarSelectorGrow {
    0% {
        transform: scaleY(0);
    }
    100% {
        transform: scaleY(1);
    }
}

/* --- Base Row Setup (Unchanged) --- */
.urlbarView-row {
    padding: 0px 0px !important;
    border-left: 0px !important;
    padding-left: 3px !important;
    @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
        margin-inline: 3px !important;
    }
    @media (-moz-pref("userChrome.ui-chrome-refresh")) {
        margin-inline: 2px !important;
    }
    border-radius: 0px !important;
    position: relative !important;
}

/* --- Base Row Setup (Unchanged) --- */
.urlbarView-row {
    padding: 0px 0px !important;
    border-left: 0px !important;
    padding-left: 3px !important;
    @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
        margin-inline: 3px !important;
    }
    @media (-moz-pref("userChrome.ui-chrome-refresh")) {
        margin-inline: 2px !important;
    }
    border-radius: 0px !important;
    position: relative !important;
}

/* --- Base Row Setup (Unchanged) --- */
.urlbarView-row {
    padding: 0px 0px !important;
    border-left: 0px !important;
    padding-left: 3px !important;
    @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
        margin-inline: 3px !important;
    }
    @media (-moz-pref("userChrome.ui-chrome-refresh")) {
        margin-inline: 2px !important;
    }
    border-radius: 0px !important;
    position: relative !important;
}

/* ðŸš€ The Element to be Animated (urlbarView-row-inner::before) */
.urlbarView-row-inner::before {
    content: "" !important;
    display: block !important;
    position: absolute !important;
    left: 0px !important;
    
    /* Full Height Definition */
    top: 0px !important;
    height: 100% !important;

    /* Sizing and Appearance */
    min-width: 4px !important;
    max-width: 4px !important;
    background-color: var(--md-accent-color) !important;
    
    /* REVERTED: Use your original clip-path definition for the full shape */
    clip-path: inset(0 0 0 0 round 0px 5px 5px 0px) !important;
    
    z-index: 1 !important;
    
    /* INITIAL (UNSELECTED) STATE: Hidden */
    transform-origin: center !important;
    transform: scaleY(0) !important;
    
    /* TRANSITION OUT (Instant Disappearance) */
    transition: transform 0s !important; 
}

/* ðŸ–±ï¸ NEW FIX: HOVER STATE (Clip-Path Override for Fixed Radius) */
.urlbarView-row-inner:hover::before {
    /* Set the smooth transition (100ms) ONLY when hovering IN */
    transition: transform 120ms ease-out !important; 
    
    /* BORDER RADIUS FIX: Use clip-path to visually shrink the bar.
       We want 40% height, so we hide 30% from the top and 30% from the bottom.
       (100% - 40% = 60%; 60% / 2 = 30%)
    */
    clip-path: inset(25% 0 25% 0 round 0px 5px 5px 0px) !important;
    
    /* Make sure the element is visible */
    transform: scaleY(1) !important;
}

/* ðŸŒŸ Selected State: Full size and the longer IN animation */
.urlbarView-row-inner[selected]::before {
    /* TRANSITION IN (Selected): Override the 0s transition with the smooth animation time. */
    transition: transform 240ms cubic-bezier(0,0,0,1) !important;
    
    /* FINAL (SELECTED) STATE: Visible (full size) */
    transform: scaleY(1) !important;
    
    /* CRITICAL: Must revert the clip-path to show the full height (0% inset) */
    clip-path: inset(0 0 0 0 round 0px 5px 5px 0px) !important;
}

/* --- Selected Row Styling (Unchanged) --- */
.urlbarView-row[selected] {
    color: var(--md-tab-label-color) !important;
    text-shadow: 1px 1px 2px #000 !important;
}

.urlbarView-row {
  &[selected]:active {
    background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
  }
}

.urlbarView-button {
  &[selected] {
    outline-color: var(--md-accent-color) !important;
  }
}

.urlbarView-results {
  padding-block: 0 10px !important;
}

/*
.tab-background {
  position: relative;
}

.tab-background[selected='']::after {

  content: '';
  position: absolute;
  top: 0px;
  width: 3px;
  height: 100%;
  background-color: var(--zen-primary-color);
}
  */


/* Materialfox already does this, but also here in case.. */
#tabbrowser-tab-tooltip {
    display: inherit !important;
}

/* Puts tooltip on close button on tab */
#tabbrowser-tab-tooltip:not([data-l10n-id="tabbrowser-close-tabs-tooltip"]){
    visibility: hidden !important;
  }

/* Hide Materialfox new tab previews */

.tabbrowser-tab:not([selected]):after {
    display: none !important;
}

.tabbrowser-tab:hover[selected]:after {
    display: none !important;
}

/* Make URLbar indent slightly and bold/bigger text */
.urlbar-input, #urlbar-input, #searchbar {
  color: var(--md-tab-label-color) !important;
  padding-left: 2px !important;
  font-size: 14px !important;
  font-weight: 500 !important;
  font-family: "Segoe UI Variable Display" !important;
  font-smooth: always !important;
  text-rendering: optimizelegibility !important;
  -webkit-font-smoothing: antialiased !important;
}


.urlbar[breakout-extend][focused] {
  & > .urlbar-input-container {
    padding-inline: 9px !important;
    .urlbar-input {
      margin-left: 7px !important;
    }
  }
}
.tabbrowser-tab:is([image], [pinned]) > .tab-stack > .tab-content[attention]:not([selected]), .tabbrowser-tab > .tab-stack > .tab-content[pinned][titlechanged]:not([selected]), #tabbrowser-tabs[orient="vertical"] .tabbrowser-tab > .tab-stack > .tab-content[titlechanged]:not([selected]) {
  background-image: radial-gradient(circle, var(--md-accent-color), var(--md-accent-color) 2px, transparent 2px) !important;
}
/*
.urlbar-input {
    #urlbar[focused] > .urlbar-input-container > .urlbar-input-box > & {
        padding-left: 20px !important;
    }
}

 /*
  #urlbar-input {
    transition: transform 110ms linear;
    transform: translateX(0);
    position: inherit;
    width: 100%;
    text-align: left !important;
    }

    #urlbar-input #urlbar[focused] > .urlbar-input-container > .urlbar-input-box > & {
    position: inherit;
    transform: translateX(0);
    transition: all 110ms ease;
    width: 100%;
    text-align: left !important;
    padding-inline: 20px !important;
    }*/

  #urlbar:is([open]) .urlbar-background {
    background-color: var(--md-background-color-0) !important;
  }
/* Animate the search breakout window like FFPlus
@media not (prefers-reduced-motion: reduce) {
  #urlbar[open] .urlbarView,
  #urlbar[breakout][breakout-extend] > .urlbar-background {
    animation-name: fp-urlbar-animation !important;
    animation-duration: 120ms !important;
    transform-origin: top !important;
    animation-timing-function: cubic-bezier(0.075, 0.82, 0.165, 1) !important;
  }
}*/

@keyframes fp-urlbar-animation {
	from {
		opacity: 0;
		transform: scaleY(0);
	}

	to {
		opacity: 1;
		transform: scaleY(1);
	}
}

#urlbar[open] .urlbar-background, #urlbar[open] #searchbar {
  box-shadow: rgb(0, 0, 0, 0.25) 0px 18px 18px 4px !important;
  @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
    margin-top: 0px !important;
    border: 1px solid !important;
    border-color: var(--md-menu-border-color) !important;
    border-radius: 8px !important;
  }
  @media (-moz-pref("userChrome.ui-chrome-refresh")) {
    margin-top: 1px !important;
    border: 0px !important;
    border-color: var(--md-menu-border-color) !important;
    border-radius: 14px !important;
  }
}





/* Making the context and other mensu look a little better and even */
@media (-moz-platform: windows), (-moz-platform: linux) {
    menupopup, panel:not(#autoscroller) {
        --panel-border-radius: 8px !important;
        border-radius: var(--panel-border-radius) !important;
        --panel-padding: 4px !important;
    }
}

menupopup, panel {
  &::part(content) {
    border-radius: 8px !important;
  }
}

menupopup {
  @media (-moz-windows-mica-popups) {
      appearance: none !important;
  }
}

@media (-moz-platform: windows), (-moz-platform: linux) {
    menu, menuitem {
        margin-inline-start: 0px !important;
        margin-inline-end: 0px !important;
        padding-block: 14px !important;
        color: light-dark(MenuText, var(--md-tab-label-color)) !important;
        font-family: system-ui !important;
    }
}

#ContentSelectDropdown > menupopup > menucaption, #ContentSelectDropdown > menupopup > menuitem {
  font-family: system-ui !important;
}

select menupopup, select menuitem, menulist menupopup, menulist menuitem, .expander-down menupopup, .expander-down menuitem, .expander-up menupopup, .expander-up menuitem, button[type="menu"] menupopup, button[type="menu"] menuitem {
  line-height: normal !important;
}

/* Reduce padding on context menu separators */
menuseparator::before {
    margin-inline-start: 0px !important;
    margin-inline-end: 0px !important;
}

menuseparator {
    padding-inline: 0px !important;
}

/* Avoid clipping of the bookmark menu items
.toolbar-menupopup {
    &, & menupopup {
      margin-left: -3px !important;
    }
  } */

/* Changing border radius on the bookmark toolbar items
#PlacesToolbarItems > .bookmark-item {
    border-radius: 100px !important;
}*/

/* More consistent active button color */
menuitem {
    &[_moz-menuactive]:not([disabled="true"]):active {
      background-color: light-dark(color-mix(in srgb, AccentColor 86%, white), color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white)) !important;
    }
    &:where([_moz-menuactive="true"]):not([disabled="true"]) {
      color: light-dark(AccentColorText, var(--md-tab-label-color)) !important;
    }
  }

  /* Adjusting find bar border/position */
  .browserContainer > findbar {
    margin: 2px 17px 0 0 !important;
  }

  /* .tab-label-container[textoverflow]:not([pinned]) { mask-image: unset !important; } */

  /* Making mousehover on tabs not change the label fading thing in any way */
.tabbrowser-tab {
    --tab-label-mask-size: 20px !important;
    /* text-shadow: 1px 1px 2px #000 !important; */
}

.tabbrowser-tab {
  position: unset !important;
}
#tabbrowser-arrowscrollbox-periphery {
    left: 0px !important;
}

@media not (-moz-pref("userChrome.ui-chrome-refresh")) {
  html,
  body {
    --tab-vertical-padding: 4px !important;
  }

  .tabbrowser-tab,
  .tabbrowser-tab[pinned] {
    .tab-stack {
      min-height: var(--tab-min-height) !important;
      max-height: var(--tab-min-height) !important;
    }
  }

  .tab-background {
    margin-top: var(--tab-vertical-padding) !important;
    min-height: calc(var(--tab-min-height) - var(--tab-vertical-padding)) !important;
    max-height: calc(var(--tab-min-height) - var(--tab-vertical-padding)) !important;
  }
}

/* Indent the search to match the breakout box indentation like Chrome
#urlbar[pageproxystate="invalid"] #identity-box {
    transition-duration: 105ms !important;
    transition-timing-function: cubic-bezier(0, 0, .2, 1) !important;
    padding-right: 9px !important;
} */



#identity-permission-box {

  #urlbar & {
    margin-inline-start: -24px !important;
    opacity: 0 !important;
    transition: margin-inline-start 130ms cubic-bezier(0, 0, 0.2, 1) 500ms, opacity 30ms ease 500ms !important;
  }

  #urlbar:has(#identity-box:not(.chromeUI):hover) &,
  #urlbar:has(#identity-box:not(.chromeUI):active) &,
  #urlbar:has(#identity-box:not(.chromeUI):focus-within) &,
  #urlbar:has(#identity-box:not(.chromeUI):focus) &,
  #urlbar:has(#identity-box[open="true"]:not(.chromeUI)) &,
  #urlbar:has(#identity-icon:not(.chromeUI):hover) &,
  #urlbar:has(#identity-icon:not(.chromeUI):active) &,
  #urlbar:has(#identity-icon:not(.chromeUI):focus-within) &,
  #urlbar:has(#identity-icon:not(.chromeUI):focus) &,
  #urlbar:has(#identity-icon[open="true"]:not(.chromeUI)) &,
  #urlbar:has(#identity-icon-box:not(.chromeUI):hover) &,
  #urlbar:has(#identity-icon-box:not(.chromeUI):active) &,
  #urlbar:has(#identity-icon-box:not(.chromeUI):focus-within) &,
  #urlbar:has(#identity-icon-box:not(.chromeUI):focus) &,
  #urlbar:has(#identity-icon-box[open="true"]:not(.chromeUI)) &,
  #urlbar &:hover:active,
  #urlbar &[open="true"],
  #urlbar &:focus-within {
    margin-inline-start: 2px !important;
    opacity: 1 !important;
    transition: margin-inline-start 130ms cubic-bezier(0, 0, 0.2, 1) 60ms, opacity 180ms ease 60ms !important;
    transition-delay: 400ms !important;
  }
}


#urlbar:has(#identity-permission-box:hover) .urlbar-background {
  background-color: var(--md-background-color-50) !important; /* Replace 'your-preferred-color' with the desired color */
  transition: background-color 320ms cubic-bezier(0, 0, .2, 1) !important; /* Add a transition effect */
  transition-delay: 40ms !important;
}

#urlbar:has(#identity-icon-box:hover) .urlbar-background {
  background-color: var(--md-background-color-50) !important; /* Replace 'your-preferred-color' with the desired color */
  transition: background-color 320ms cubic-bezier(0, 0, .2, 1) !important; /* Add a transition effect */
  transition-delay: 40ms !important;
}

#urlbar:has(#page-action-buttons:hover) .urlbar-background {
  background-color: var(--md-background-color-50) !important; /* Replace 'your-preferred-color' with the desired color */
  transition: background-color 320ms cubic-bezier(0, 0, .2, 1) !important; /* Add a transition effect */
  transition-delay: 40ms !important;
}

#urlbar:has(#tracking-protection-icon-container:hover) .urlbar-background {
  background-color: var(--md-background-color-50) !important; /* Replace 'your-preferred-color' with the desired color */
  transition: background-color 320ms cubic-bezier(0, 0, .2, 1) !important; /* Add a transition effect */
  transition-delay: 40ms !important;
}

#urlbar:has(.notification-anchor-icon:hover) .urlbar-background {
  background-color: var(--md-background-color-50) !important; /* Replace 'your-preferred-color' with the desired color */
  transition: background-color 320ms cubic-bezier(0, 0, .2, 1) !important; /* Add a transition effect */
  transition-delay: 40ms !important;
}

/* Colors the URL bar on mouseover 


/*
#urlbar[focused]:not([suppress-focus-border]) > #urlbar-background, #searchbar:focus {
  outline: 1px solid var(--md-accent-color) !important;
} */

/*
    #urlbar[pageproxystate="invalid"][breakout][focused] #identity-box {
        position: inherit;
        transform: translateX(0);
        transition: all 150ms ease;
        padding-right: 18px !important;
    } */

/* Change text on bookmark items to match the theme */
toolbarbutton.bookmark-item > .toolbarbutton-text {
    color: var(--md-tab-label-color) !important;
}

    /*:is(menupopup, panel):where([type="arrow"]) */

/*  Change svg icon color to match text color */
@media not (-moz-pref("userChrome.ui-no-menu-icons")) {
    .panel-subview-body > .subviewbutton:not([disabled]) {
        fill: var(--md-text-primary) !important;
    }
}

#allTabsMenu-containerTabsButton,
#allTabsMenu-searchTabs,
#panelMenu_showAllBookmarks,
#PanelUI-historyMore,
#appmenu-developer-tools-view > .subviewbutton,
#unified-extensions-manage-extensions,
#identity-popup-more-info,
#identity-popup-clear-sitedata-button,
#protections-popup-category-cookies,
#protections-popup-category-trackers,
#protections-popup-category-socialblock,
#protections-popup-category-fingerprinters,
#protections-popup-category-cryptominers,
#protections-popup-report-broken-site-button,
#appMenu-library-recentlyClosedWindows > .restoreallitem,
#appMenu-library-recentlyClosedTabs > .restoreallitem {
  -moz-context-properties: fill !important;

  & > .toolbarbutton-icon {
    -moz-context-properties: fill !important;
    fill: var(--md-text-primary) !important;
  }
}
#allTabsMenu-containerTabsButton:hover,
#allTabsMenu-searchTabs:hover,
#panelMenu_showAllBookmarks:hover,
#PanelUI-historyMore:hover,
#appmenu-developer-tools-view > .subviewbutton:hover,
#unified-extensions-manage-extensions:hover,
#identity-popup-more-info:hover,
#identity-popup-clear-sitedata-button:hover,
#protections-popup-category-cookies:not([disabled]):hover,
#protections-popup-category-trackers:not([disabled]):hover,
#protections-popup-category-socialblock:not([disabled]):hover,
#protections-popup-category-fingerprinters:not([disabled]):hover,
#protections-popup-category-cryptominers:not([disabled]):hover,
#protections-popup-report-broken-site-button:not([disabled]):hover,
#appMenu-library-recentlyClosedWindows > .restoreallitem:hover,
#appMenu-library-recentlyClosedTabs > .restoreallitem:hover {
  & > .toolbarbutton-icon {
    -moz-context-properties: fill !important;
    fill: var(--md-accent-color) !important;
  }  /* Web Developer Tools */
}

#protections-popup-category-cookies[disabled],
#protections-popup-category-trackers[disabled],
#protections-popup-category-socialblock[disabled],
#protections-popup-category-fingerprinters[disabled],
#protections-popup-report-broken-site-button[disabled],
#protections-popup-category-cryptominers[disabled] {
  & > .toolbarbutton-icon {
    -moz-context-properties: fill !important;
    fill: var(--md-text-secondary) !important;
  }  
}

#protections-popup-report-broken-site-button {
  list-style-image: url("chrome://global/skin/icons/newsfeed.svg") !important;
}

#protections-popup-report-broken-site-button:not([disabled]):hover {
  & > .protections-popup-report-broken-site-icon {
    -moz-context-properties: fill, fill-opacity !important;
    fill: var(--md-accent-color) !important;
  }
}

#protections-popup-settings-button > .protections-popup-settings-icon {
  list-style-image: url("chrome://global/skin/icons/settings.svg") !important;
  -moz-context-properties: fill, fill-opacity !important;
  fill: var(--md-text-primary) !important;
  margin-inline-end: 1em !important;
}

#protections-popup-settings-button:not([disabled]):hover {
  & > .protections-popup-settings-icon {
    -moz-context-properties: fill, fill-opacity !important;
    fill: var(--md-accent-color) !important;
  }
}

#protections-popup-show-report-button > .protections-popup-show-report-icon {
  list-style-image: url("dashboard.svg") !important;
  -moz-context-properties: fill, fill-opacity !important;
  fill: var(--md-text-primary) !important;
  margin-inline-end: 1em !important;
}

#protections-popup-show-report-button:not([disabled]):hover {
  & > .protections-popup-show-report-icon {
    -moz-context-properties: fill, fill-opacity !important;
    fill: var(--md-accent-color) !important;
  }
}

#protections-popup-trackersView-settings-button {
  list-style-image: url("chrome://global/skin/icons/settings.svg") !important;
  -moz-context-properties: fill, fill-opacity !important;
  fill: var(--md-text-primary) !important;
}

#protections-popup-trackersView-settings-button:hover {
    -moz-context-properties: fill, fill-opacity !important;
    fill: var(--md-accent-color) !important;
}

#protections-popup-fingerprintersView-settings-button {
  list-style-image: url("chrome://global/skin/icons/settings.svg") !important;
  -moz-context-properties: fill, fill-opacity !important;
  fill: var(--md-text-primary) !important;
}

#protections-popup-fingerprintersView-settings-button:hover {
    -moz-context-properties: fill, fill-opacity !important;
    fill: var(--md-accent-color) !important;
}

#protections-popup-socialblockView-settings-button {
  list-style-image: url("chrome://global/skin/icons/settings.svg") !important;
  -moz-context-properties: fill, fill-opacity !important;
  fill: var(--md-text-primary) !important;
}

#protections-popup-socialblockView-settings-button:hover {
    -moz-context-properties: fill, fill-opacity !important;
    fill: var(--md-accent-color) !important;
}

#protections-popup-cryptominersView-settings-button {
  list-style-image: url("chrome://global/skin/icons/settings.svg") !important;
  -moz-context-properties: fill, fill-opacity !important;
  fill: var(--md-text-primary) !important;
}

#protections-popup-cryptominersView-settings-button:hover {
    -moz-context-properties: fill, fill-opacity !important;
    fill: var(--md-accent-color) !important;
}

#protections-popup-cookiesView-settings-button {
  list-style-image: url("chrome://global/skin/icons/settings.svg") !important;
  -moz-context-properties: fill, fill-opacity !important;
  fill: var(--md-text-primary) !important;
}

#protections-popup-cookiesView-settings-button:hover {
    -moz-context-properties: fill, fill-opacity !important;
    fill: var(--md-accent-color) !important;
}

.toolbarbutton-1 {
  fill: var(--md-text-primary) !important;
}

/* Tab separator moved 1px left for chrome since it was mis-aligned */
.tab-content {
  overflow: visible !important;
    &::before,
    &::after {
      @media (-moz-pref("userChrome.ui-chrome-refresh")) {
        width: 2px !important;
        height: 16px !important;
        left: -1px !important;
      }
      @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
        width: 1px !important;
        height: 20px !important;
        left: 0 !important;
      }
    }
}

/* --- Material-Fox Pinned to Unpinned Separator --- */

/* 1. Create the separator ONLY if pinned tabs exist in the bar */
#tabbrowser-tabs:has(.tabbrowser-tab[pinned]) .tabbrowser-tab:not([pinned]):first-of-type .tab-content::before {
    content: "" !important;
    display: block !important;
    position: absolute !important;
    background-color: var(--md-content-separator-color) !important;
    opacity: var(--tab-separator-opacity, 1) !important;
    width: 1px !important;
    height: 18px !important;
    left: -1px !important;
    top: calc((var(--tab-min-height) - 18px) / 2) !important;
    pointer-events: none !important;
    visibility: visible !important;
}

/* 2. Refresh UI adjustments */
@media (-moz-pref("userChrome.ui-chrome-refresh")) {
    #tabbrowser-tabs:has(.tabbrowser-tab[pinned]) .tabbrowser-tab:not([pinned]):first-of-type .tab-content::before {
        left: -1px !important;
        width: 2px !important;
        height: 16px !important;
        top: calc((var(--tab-min-height) - 16px) / 2) !important;
    }
}

/* 3. Interaction Hide Logic */
#tabbrowser-tabs:has(.tabbrowser-tab:not([pinned]):first-of-type:is(:hover, [selected], [visuallyselected], [multiselected])) 
.tabbrowser-tab:not([pinned]):first-of-type .tab-content::before,
#tabbrowser-tabs:has(.tabbrowser-tab[pinned]:last-of-type:is(:hover, [selected], [visuallyselected], [multiselected])) 
.tabbrowser-tab:not([pinned]):first-of-type .tab-content::before {
    opacity: 0 !important;
    visibility: hidden !important;
}

/* 4. THE FIX: Only hide the FIRST separator if no pinned tabs exist */
/* This leaves the standard separators between your other tabs alone */
#tabbrowser-tabs:not(:has(.tabbrowser-tab[pinned])) .tabbrowser-tab:first-of-type .tab-content::before {
    display: none !important;
}


/* --- Final Tab to New Tab Button Separator --- */

/* 1. Base Definition */
#tabs-newtab-button::before,
#TabsToolbar #new-tab-button::before {
    content: "" !important;
    display: block !important;
    position: absolute !important;
    background-color: var(--md-content-separator-color) !important;
    opacity: var(--tab-separator-opacity, 1) !important;
    visibility: visible !important;
    pointer-events: none !important;
    width: 1px !important;
    height: 20px !important;
    left: 2px !important; 
    top: calc((var(--tab-min-height) - 20px) / 2) !important;
    z-index: 10 !important;
}

/* 2. Refresh UI Adjustments */
@media (-moz-pref("userChrome.ui-chrome-refresh")) {
    #tabs-newtab-button::before,
    #TabsToolbar #new-tab-button::before {
        width: 2px !important;
        height: 16px !important;
        left: 1px !important; 
        top: calc((var(--tab-min-height) - 16px) / 2) !important;
    }
}

/* 3. High-Priority Hide Logic */

/* A. Hide when the New Tab Button itself is hovered */
/* --- High-Priority Hide Logic (Pinned-Safe) --- */

/* A. Hide when the New Tab Button itself is hovered */
#tabs-newtab-button:hover::before,
#new-tab-button:hover::before {
    opacity: 0 !important;
    visibility: hidden !important;
}

/* B. Surgical Hide: Only triggers if the last tab is NOT PINNED */
#tabbrowser-tabs:has(> #tabbrowser-arrowscrollbox .tabbrowser-tab[last-visible-tab]:not([pinned]):hover) #tabs-newtab-button::before,
#tabbrowser-tabs:has(> #tabbrowser-arrowscrollbox .tabbrowser-tab[last-visible-tab]:not([pinned])[selected]) #tabs-newtab-button::before,
#tabbrowser-tabs:has(> #tabbrowser-arrowscrollbox .tabbrowser-tab[last-visible-tab]:not([pinned])[visuallyselected]) #tabs-newtab-button::before,
#tabbrowser-tabs:has(> #tabbrowser-arrowscrollbox .tabbrowser-tab[last-visible-tab]:not([pinned])[multiselected]) #tabs-newtab-button::before {
    opacity: 0 !important;
    visibility: hidden !important;
}

/* C. Fallback for overflow (ensure it's not a pinned tab) */
#tabbrowser-tabs:has(.tabbrowser-tab:last-of-type:not([pinned]):hover) #tabs-newtab-button::before,
#tabbrowser-tabs:has(.tabbrowser-tab:last-of-type:not([pinned])[selected]) #tabs-newtab-button::before {
    opacity: 0 !important;
    visibility: hidden !important;
}


/* --- New Tab Button Fix for Pinned-Only State --- */

/* 1. Move the Button Right (6px shift as requested) */
/* Targets the button only when no unpinned tabs exist */
#tabbrowser-tabs:not(:has(.tabbrowser-tab:not([pinned]))) #tabs-newtab-button,
#tabbrowser-tabs:not(:has(.tabbrowser-tab:not([pinned]))) #new-tab-button {
  @media (-moz-pref("userChrome.ui-chrome-refresh")) {
    margin-inline-start: 3px !important; 
  }
  @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
  margin-inline-start: 9px !important; 
  }
}

/* 2. Hide Separator when the Last Pinned Tab is Active */
/* This works even if the button and tabs are in different internal containers */

/* If the last-of-type pinned tab is Hovered */
#tabbrowser-tabs:not(:has(.tabbrowser-tab:not([pinned]))):has(.tabbrowser-tab[pinned]:last-of-type:hover) #tabs-newtab-button::before,
#tabbrowser-tabs:not(:has(.tabbrowser-tab:not([pinned]))):has(.tabbrowser-tab[pinned]:last-of-type:hover) #new-tab-button::before,

/* If the last-of-type pinned tab is Selected */
#tabbrowser-tabs:not(:has(.tabbrowser-tab:not([pinned]))):has(.tabbrowser-tab[pinned]:last-of-type[selected]) #tabs-newtab-button::before,
#tabbrowser-tabs:not(:has(.tabbrowser-tab:not([pinned]))):has(.tabbrowser-tab[pinned]:last-of-type[selected]) #new-tab-button::before,

/* If the last-of-type pinned tab is Visually Selected (Theme state) */
#tabbrowser-tabs:not(:has(.tabbrowser-tab:not([pinned]))):has(.tabbrowser-tab[pinned]:last-of-type[visuallyselected]) #tabs-newtab-button::before,
#tabbrowser-tabs:not(:has(.tabbrowser-tab:not([pinned]))):has(.tabbrowser-tab[pinned]:last-of-type[visuallyselected]) #new-tab-button::before {
    opacity: 0 !important;
    visibility: hidden !important;
    display: none !important;
}

/* 1. Base State (Mouse Exit): Snap-in then slow-bleed opacity */
.tab-content::before, 
.tab-content::after, 
#tabs-newtab-button::before, 
#new-tab-button::before {
  /* This bezier curve makes it pop in slightly then take its time fading the rest of the way */
  transition: 
    opacity 1000ms cubic-bezier(0.1, 0.9, 0.2, 1), 
    visibility 1000ms !important;
}

/* 2. Hover Entry: Snap to instant disappearance (0ms) */

/* A. Standard Tabs */
.tabbrowser-tab:is(:hover, [selected], [multiselected]) .tab-content::before,
.tabbrowser-tab:is(:hover, [selected], [multiselected]) .tab-content::after,
.tabbrowser-tab:is(:hover, [selected], [multiselected]) + .tabbrowser-tab .tab-content::before,

/* B. New Tab Button Fix */
#tabs-newtab-button:hover::before,
#new-tab-button:hover::before,
#tabbrowser-tabs:has(.tabbrowser-tab[last-visible-tab]:is(:hover, [selected], [multiselected])) #tabs-newtab-button::before,
#tabbrowser-tabs:has(.tabbrowser-tab[last-visible-tab]:is(:hover, [selected], [multiselected])) #new-tab-button::before,
#tabbrowser-tabs:has(.tabbrowser-tab:last-of-type:is(:hover, [selected], [multiselected])) #tabs-newtab-button::before,
#tabbrowser-tabs:has(.tabbrowser-tab:last-of-type:is(:hover, [selected], [multiselected])) #new-tab-button::before,

/* C. Pinned-to-Unpinned Boundary */
#tabbrowser-tabs:has(.tabbrowser-tab[pinned]:last-of-type:is(:hover, [selected], [multiselected])) .tabbrowser-tab:not([pinned]):first-of-type .tab-content::before,
#tabbrowser-tabs:has(.tabbrowser-tab:not([pinned]):first-of-type:is(:hover, [selected], [multiselected])) .tabbrowser-tab:not([pinned]):first-of-type .tab-content::before {
  transition: none !important;
}


/* Bookmark folders same as secondary text color */
.bookmark-item[container="true"] {
    fill: var(--md-text-secondary) !important;
} 

/* Right arrows same color as accent color */
#protections-popup-mainView .subviewbutton-nav:not(.notFound)::after,
#identity-popup-mainView .subviewbutton-nav::after,
.widget-overflow-list .subviewbutton-nav::after,
.PanelUI-subView .subviewbutton-nav::after,
.menu-right {
  -moz-context-properties: fill, fill-opacity !important;
    height: 16px !important;
    width: 16px !important;
    fill: var(--md-accent-color) !important;
    fill-opacity: 1 !important;
}

.menu-right {
  margin-inline-end: 6px !important;
}

.subviewbutton-iconic:not([class*="identity-color-"],[class*="all-tabs-button"],[class*="bookmark-item"]) > .toolbarbutton-icon {
  fill: var(--md-accent-color) !important;
}

.subviewbutton-iconic:is([class*="all-tabs-button"],[class*="bookmark-item"]) > .toolbarbutton-icon {
  fill-opacity: 1 !important;
  fill: var(--md-icon-color-secondary) !important;
}

/* Bookmark menu chevron overflow icon same as secondary text color */
#PlacesChevron:not([collapsed]) .toolbarbutton-icon {
    fill: var(--md-text-primary) !important;
    fill-opacity: 1 !important;
    width: calc(2 * var(--toolbarbutton-inner-padding) + 16px) !important;
    align-items: center !important;
    justify-content: center !important;
    /*filter: drop-shadow(0 0 2px var(--md-accent-color)) drop-shadow(0 0 3px var(--md-selection-background-color)) !important; */
  }

/* Changed panel header padding/font to look better/more consistent */
.panel-header {
    padding: 4px 8px 0px 0px !important;
    font-weight: 600 !important;
    text-shadow: 1px 1px 4px #000 !important;
    font-size: 13px !important;
}

/* Bookmark and History scrollbar colors in the Arrowpanel menu */
.panel-subview-body {
    scrollbar-color: var(--md-menu-border-color) var(--md-menu-background-color) !important;
}
.panel-subview-body:hover {
    scrollbar-color: color-mix(in srgb, var(--md-menu-border-color) 90%, white) var(--md-menu-background-color) !important;
}
.panel-subview-body:active {
    scrollbar-color: color-mix(in srgb, var(--md-menu-border-color) 70%, white) var(--md-menu-background-color) !important;
}

#permList, scrollbar {
    scrollbar-color: var(--md-menu-border-color) var(--md-menu-background-color) !important;
}
#permList, scrollbar:hover {
    scrollbar-color: color-mix(in srgb, var(--md-menu-border-color) 90%, white) var(--md-menu-background-color) !important;
}
#permList, scrollbar:active {
    scrollbar-color: color-mix(in srgb, var(--md-menu-border-color) 70%, white) var(--md-menu-background-color) !important;
}
/*
#TabsToolbar-customization-target{
    counter-reset: tab-counter;
}

.tabbrowser-tab:not([hidden]){
    counter-increment: tab-counter;
}

    #alltabs-button >.toolbarbutton-badge-stack > .toolbarbutton-icon{
    opacity: 0; 
}

#alltabs-button >.toolbarbutton-badge-stack::before{
    content: counter(tab-counter);
    display: flex;
    grid-area: 1/1;
    justify-content: center;
    color: var(--toolbarbutton-icon-fill);
    border-bottom: 1px solid;
    contain: inline-size;
}
*/

#appMenu-header-description {
    font-size: larger !important;
    text-shadow: 1px 1px 4px #000 !important;
}

#appMenu-fxa-text, #appMenu-fxa-status2[fxastatus] > #appMenu-fxa-label2 {
    margin: 0px !important;
}

#appMenu-report-broken-site-button {
  display: none !important;
}

.toolbarbutton-badge {
  min-width: fit-content !important;
  color: var(--md-white) !important;
  background-color: var(--md-selection-background-color) !important;
  text-shadow: 1px 1px 2px black !important;
  font-family: "Inter" !important;
  font-smooth: always !important;
  text-rendering: optimizelegibility !important;
  font-size: 10px !important;
  text-align: center !important;
  justify-content: center !important;
  font-weight: 600 !important;
  padding-top: 2px !important;
  padding-bottom: 2px !important;
  padding-left: 3px !important;
  padding-right: 3px !important;
  border: 0px !important;
  border-radius: 4px !important;
  filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.35)) !important;
}

.toolbarbutton-1:is(#back-button, #forward-button),
#context-back,
#context-forward,
.subviewbutton-back,
.identity-popup-expander {
  list-style-image: url("Back.svg") !important;
}


.unified-nav-forward[_moz-menuactive]:-moz-locale-dir(ltr),
.unidied-nav-back[_moz-menuactive]:-moz-locale-dir(rtl) {
  list-style-image: url("Forward.svg") !important;
}


.unified-nav-back[_moz-menuactive]:-moz-locale-dir(ltr),
.unidied-nav-forward[_moz-menuactive]:-moz-locale-dir(rtl) {
  list-style-image: url("Back.svg") !important;
}

:is(panelview .toolbarbutton-1, toolbarbutton.subviewbutton, .widget-overflow-list .toolbarbutton-1, .toolbaritem-combined-buttons:is(:not([cui-areatype="toolbar"]), [overflowedItem="true"]) > toolbarbutton) {
  &:not([disabled]):hover {
    fill: var(--md-accent-color) !important;
  }
}

#PlacesToolbarItems > .bookmark-item:active {
    transition: background-color 0.25s ease-in-out !important;
}

.tabbrowser-tab:is([selected], [multiselected]):-moz-lwtheme {
	z-index: 1 !important;
}

.tabbrowser-tab:is([visuallyselected], [multiselected]):not([pinned]) {
	min-width: 200px !important;
	z-index: 1 !important;
}

#titlebar {
	z-index: 1 !important;
}

#alltabs-button {
  box-shadow: unset !important;
  filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.46)) !important;
}

.all-tabs-item {
  margin-inline: 0px !important;
}

.titlebar-buttonbox-container {
  margin: 0 0 0 20px !important;
}

.tab-content {
  padding: 0 11px !important;
}

.tab-close-button {
  list-style-image: url("closetab.svg") !important;
  fill-opacity: 1 !important;
  -moz-context-properties: fill, fill-opacity !important;
}


@media (-moz-pref("userChrome.ui-chrome-refresh")) {

  #tabbrowser-arrowscrollbox .tabbrowser-tab:is(:first-child) {
    margin-left: 6px !important;
  }

/* Default: rounded top corners */
    /* Default: rounded top corners */
  #nav-bar {
    border-radius: 8px 8px 0 0 !important;
    min-height: 45px !important;
  }

  /* Square top-left when first non-pinned tab (in arrowscrollbox) is selected
     but only when there are no pinned tabs present. If pinned tabs exist,
     prefer the pinned-tab rules. */
  #navigator-toolbox:not(:has(#pinned-tabs-container > .tabbrowser-tab)):has(#tabbrowser-arrowscrollbox > .tabbrowser-tab[selected="true"]:first-child) #nav-bar {
    border-radius: 0px 8px 0 0 !important;
  }

  /* Also square top-left when the first pinned tab is selected (pinned tabs
     may live in `#pinned-tabs-container`). */
  #navigator-toolbox:has(#pinned-tabs-container > .tabbrowser-tab[selected="true"]:first-child) #nav-bar {
    border-radius: 0px 8px 0 0 !important;
  }

  #tabbrowser-tabs:not([overflow]) ~ #alltabs-button {
    display: none !important;
    margin-left: 0px !important;
  }

  .tab-background {
    border-radius: 10px !important;
  }

  .tab-content {
    padding-inline-end: 15px !important;
  
    #tabbrowser-tabs[closebuttons="activetab"][orient="horizontal"] &:not([selected]) {
      padding-inline-end: 15px !important;
    }
  }

  .tab-close-button {
    margin-inline-end: calc(var(--tab-inline-padding) / -1.4) !important;
  }

  #alltabs-button {
    margin-top: -2px !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    margin-bottom: 0 !important;
    fill: var(--md-tab-label-color) !important;
    .toolbarbutton-badge-stack {
      border-radius: 10px !important;
    }
  }
  .tabbrowser-tab:is([visuallyselected], [selected]) .tab-background {
    &::before {
      background-color: transparent !important;
      box-shadow: 4px 4px 0 4px var(--tab-background-color) !important;
    }

    &::after {
      background-color: transparent !important;
      box-shadow: -4px 4px 0 4px var(--tab-background-color) !important;
    }
  }
}

.container.infobar, .container {
  color: var(--md-text-primary) !important;
  background-color: var(--md-background-color-0) !important;
  border-radius: 8px !important;
}

:host(.infobar) {
  &::before {
    background-image: none !important;
  }
}

.container #blockedPopupOptionsButton {
  border: 2px solid #FF0000; /* Change border color */
}

.container #blockedPopupOptionsButton:hover {
  background-color: #FFFF00; /* Change hover background color */
}

.container #blockedPopupOptionsButton:active {
  background-color: #00FF00; /* Change active background color */
}

/*.urlbar-input-container:active {
  border-color: red !important;
} */
.notification-anchor-icon {
  padding: 4px !important;
}

#notification-popup-box {
  margin-left: 2px !important;
}

#notification-popup-box:hover {
  outline-offset: -1px !important;
  outline: 1px solid var(--md-menu-background-color-hover) !important;
}

#identity-permission-box:hover {
  outline-offset: -1px !important;
  outline: 1px solid var(--md-menu-background-color-hover) !important;
}

.identity-box-button, #tracking-protection-icon-container {
  &:hover:active, &[open="true"] {
    outline-color: var(--md-menu-background-color-hover) !important;
    outline-offset: -1px !important;
    outline: 1px solid var(--md-menu-background-color-hover) !important;
  }
}



#urlbar[pageproxystate="invalid"]:is([focused],[usertyping],[searchmode]) {
  #identity-box.chromeUI {
    #identity-icon-box.identity-box-button {
      padding-inline: 0px !important;
      outline: 1px solid var(--md-menu-border-color) !important;
    }
  }
}

#urlbar[pageproxystate="invalid"] {
  #identity-box.chromeUI {
    #identity-icon-box.identity-box-button {
      outline: 1px solid var(--md-menu-border-color) !important;
      padding-inline: 0px !important;
    }
  }
}

#urlbar[pageproxystate="invalid"]:is([focused],[usertyping],[searchmode]) {
  #identity-box {
    #identity-icon-box.identity-box-button {
      padding-inline: 0px !important;
      outline: 1px solid var(--md-menu-border-color) !important;
    }
  }
}

#urlbar[pageproxystate="invalid"]:is([focused],[usertyping],[searchmode],[breakout-extend],[breakout]) {
  #identity-icon {
    filter: drop-shadow(0 0 2px var(--md-accent-color)) drop-shadow(0 0 4px var(--md-selection-background-color)) !important;
  }
}

#urlbar[pageproxystate="invalid"] {
  #identity-box {
    #identity-icon-box.identity-box-button {
      outline: 1px solid var(--md-menu-border-color) !important;
      padding-inline: 0px !important;
    }
  }
}

#urlbar {
  #identity-box.chromeUI {
    #identity-icon-box.identity-box-button {
      padding-inline: 8px !important;
      outline: 1px solid var(--md-menu-border-color) !important;
    }
  }
}

#urlbar {
  #identity-box.chromeUI {
    #identity-icon-box.identity-box-button:hover {
      outline: 1px solid var(--md-menu-background-color-hover) !important;
    }
  }
}


#urlbar {
  #identity-box {
    #identity-icon-box.identity-box-button:hover {
      outline: 1px solid var(--md-menu-background-color-hover) !important;
    }
  }
}

#urlbar {
  #identity-box {
    #identity-icon-box.identity-box-button:active {
      outline: 1px solid var(--md-menu-background-color-hover) !important;
    }
  }
}

#urlbar #identity-box.chromeUI #identity-icon-box.identity-box-button:active,
#urlbar #identity-box.chromeUI #identity-icon-box.identity-box-button:focus,
#urlbar #identity-box.chromeUI #identity-icon-box.identity-box-button[open] {
  outline: 1px solid var(--md-menu-background-color-hover) !important;
}

#identity-box.chromeUI {
  #identity-icon-box.identity-box-button {
    padding-inline: 0px !important;
    outline: 1px solid var(--md-menu-border-color) !important;
  }
}

#urlbar[focused]:not([suppress-focus-border]) > .urlbar-background,
  #searchbar:focus-within {
  outline: none !important;
  border: 2px solid var(--md-accent-color) !important;
} 


/*----------------========================------------------------===================== */

findbar {
  border: var(--md-menu-border-size) !important;
  border-color: var(--md-menu-border-color) !important;
  padding-left: 8px !important;

  &[hidden='true'] {
    animation: 0.5s findbar-scale-out;
  }
}

.findbar-textbox {
  &[status="notfound"] {
    background-color: rgba(255, 0, 0, 0.2) !important;
    border-color: transparent !important;
    border-radius: 4px !important;
  }
}

.tabbrowser-tab:is([visuallyselected], [multiselected]):not([pinned]) {
	min-width: 84px !important;
}

/* prevent audio playing tabs from modifying tab width */
.tabbrowser-tab {
  &:is([muted], [soundplaying], [activemedia-blocked]), .tabbrowser-tab:is([visuallyselected], [multiselected]) {
      #tabbrowser-tabs[orient="horizontal"] &:not([pinned]) {
          --tab-min-width: 104px !important;
          min-width: var(--tab-min-width) !important;
      }
  }
}

#sidebar-header {
  font-size: larger !important;
  color: var(--md-tab-label-color) !important;
  background-color: var(--md-background-color-0) !important;
  text-shadow: 1px 1px 4px #000 !important;
  border-bottom: 1px solid var(--md-menu-border-color) !important;
  padding: 6px !important;
}

#sidebar-header > #sidebar-switcher-target > #sidebar-icon {
  fill: var(--md-accent-color) !important;
  opacity: 1.0 !important;
  min-height: 18px !important;
  max-height: 18px !important;
}

treechildren::-moz-tree-row(hover) {
  background-color: var(--md-menu-background-color-hover) !important;
}

treechildren::-moz-tree-row(active) {
  background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
}

treechildren::-moz-tree-row(container selected) {
  background-color: var(--md-selection-background-color) !important;
}

treechildren::-moz-tree-row(selected) {
  background-color: var(--md-selection-background-color) !important;
}

/* Selected bright text color */
treechildren::-moz-tree-cell-text(selected),
treechildren::-moz-tree-image(selected),
treechildren::-moz-tree-twisty(selected) { 
  color: var(--md-selection-text-color) !important;
}

.sidebar-placesTree treechildren::-moz-tree-cell-text {
  padding-left: 4px !important;
  color: var(--md-tab-label-color) !important;
}

.sidebar-placesTree treechildren::-moz-tree-cell-text(hover) {
  color: var(--md-tab-label-color) !important;
}

.sidebar-placesTree::-moz-tree-image,
.sidebar-placesTreechildren::-moz-tree-image {
  -moz-context-properties: fill, fill-opacity !important;
  fill: var(--md-text-secondary) !important;
  fill-opacity: 1 !important;
}

.sidebar-placesTree treechildren::-moz-tree-cell-text(selected),
treechildren::-moz-tree-image(selected),
treechildren::-moz-tree-twisty(selected),
.sidebar-placesTreechildren::-moz-tree-image(selected),
.sidebar-placesTreechildren::-moz-tree-image(active, open) {
  color: var(--md-selection-text-color) !important;
  fill: var(--md-selection-text-color) !important;
  fill-opacity: 1 !important;
}

treechildren::-moz-tree-separator {
  border-top: 2px solid var(--md-content-separator-color) !important;
  border-bottom: none !important;
}

treechildren::-moz-tree-separator(selected) {
  border-top: 2px solid var(--md-text-secondary) !important;
  border-bottom: none !important;
}

treechildren::-moz-tree-separator(hover) {
  border-top: 2px solid var(--md-text-secondary) !important;
  border-bottom: none !important;
}



#viewButton {
  border-radius: 4px !important;
  outline-offset: -1px !important;
  outline: 1px solid var(--md-menu-border-color) !important;
  border-color: var(--md-menu-border-color) !important;
  max-height: 32px !important;
  height: 32px !important;
  padding-left: 8px !important;
  margin-left: 10px !important;
}

#viewButton:hover {
  background-color: var(--md-menu-background-color-hover) !important;
  outline-offset: -1px !important;
  outline: 1px solid var(--md-menu-background-color-hover) !important;
}

#viewButton[open] {
  background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
  outline-offset: -1px !important;
  outline: 1px solid var(--md-accent-color) !important;
}

@media not (forced-colors) {
  .close-icon:hover {
    background-color: var(--md-menu-background-color-hover) !important;
  }
  .close-icon:active {
    background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
  }
}


#input {
   &.with-icon {
    appearance: none !important;
    background-color: var(--md-background-color-50) !important;
    border: none !important;
    color: var(--md-text-primary) !important;
    border-radius: 100px !important;
    transition-property: background-color !important;
    transition-duration: 170ms !important;
    transition-timing-function: linear, cubic-bezier(0, 0, .2, 1), linear !important;
    box-sizing: border-box !important;
    outline: 1px solid var(--md-content-separator-color) !important;
    background-size: unset !important;
    -moz-context-properties: fill;
    fill: var(--md-accent-color) !important;
  }
}

#input:hover {
   &.with-icon {
    background-color: color-mix(in srgb, var(--md-background-color-50) 61%, var(--md-background-color-100)) !important;
   }
}

#input:focus {
  &.with-icon {
  border: none !important;
  outline: 2px solid var(--md-accent-color) !important;
  outline-offset: -1px !important;F
  }
}

#input {
  &[type="search"] {
      --input-background-icon: url(chrome://global/skin/icons/search-glass.svg) !important;
  }
}

input[type="search"]::-moz-search-clear-button {
    fill: var(--md-text-primary) !important;
    -moz-context-properties: fill, fill-opacity !important;
    fill-opacity: 1 !important;
    border-radius: 100px !important;
    width: 14px !important;
    height: 14px !important;
    transform: translateX(-3px) !important; 
}

#downloadsPanel-blockedSubview, #downloadsPanel-mainView {
  min-width: 37em;
  padding: 4px !important;
  border-radius: 8px !important;
}

:not(dialog, .dialogBox) :not(button-group) > button:is([accesskey], .accessory-button, [dlgtype="cancel"], .disco-cta-button, [data-l10n-id="translations-manage-language-download-button"]):not(button[type="menu"]) {
  border: 0px !important;
  margin: 0px !important;
  border-radius: 4px !important;
  color: var(--md-tab-label-color) !important;
  padding: 6px !important;
}

#downloadsPanel #downloadsFooter #downloadsHistory:hover {
  background-color: var(--md-menu-background-color-hover) !important;
}

#downloadsPanel #downloadsFooter #downloadsHistory:active {
  background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
}

#downloadsHistory {
  list-style-image: url("icons/download.svg");

}

#downloadsFooterButtons > button .button-icon {
  width: 14px !important;
  height: 14px !important;
  margin-inline-end: 1em !important;
}

#editBookmarkPanel .expander-up:hover, #editBookmarkPanel .expander-down:hover {
  background-color: var(--md-menu-background-color-hover) !important;
}

#editBookmarkPanel .expander-up:active, #editBookmarkPanel .expander-down:active {
  background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
}

#editBookmarkPanel .expander-up, #editBookmarkPanel .expander-down {
  fill: var(--md-text-primary) !important;
}

#editBookmarkPanelCancelButton,
#editBookmarkPanelRemoveButton {
    margin-left: 8px !important;
    border: var(--md-menu-border-size) var(--md-menu-border-color) !important;
}

#editBookmarkPanelCancelButton:hover,
#editBookmarkPanelRemoveButton:hover {
    background-color: var(--md-menu-background-color-hover) !important;
}

#editBookmarkPanelCancelButton:active,
#editBookmarkPanelRemoveButton:active {
    background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
    border: var(--md-menu-border-size) var(--md-accent-color) !important;
}

  /* uBlock Origin -> custom svg icon
  :is(.webextension-browser-action, .eom-addon-button
  )[data-extensionid="uBlock0@raymondhill.net"] .toolbarbutton-icon {
      list-style-image: url("ublock.svg");
  }*/


#bookmarks-menu-button {
    fill: var(--md-accent-color) !important;
    filter: drop-shadow(0 0 1px var(--md-accent-color)) drop-shadow(0 0 2px var(--md-selection-background-color)) !important;
  }

  @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
  #identity-box[pageproxystate="valid"] {
    &:is(.verifiedDomain) #identity-icon {
      list-style-image: url("security.svg") !important;
      -moz-context-properties: fill, fill-opacity !important;
      fill-opacity: 1 !important;
      fill: var(--md-text-primary) !important;
    }
  }
}
  
  @media (-moz-pref("userChrome.ui-chrome-refresh")) {
    .tabbrowser-tab[visuallyselected]:not([usercontextid]) .tab-background
    {
      box-shadow: inset 0 7px 1px -7px color-mix(in srgb, var(--md-background-color-100) 5%, var(--md-accent-color)) !important;
      /* box-shadow: inset 0 2px 0 var(--md-accent-color) !important; */
    }
  }

  /*#tabbrowser-arrowscrollbox .tabbrowser-tab:is(:first-child) {
    margin-left: 5px !important;
  }*/
  
  scrollbox:is([orient="horizontal"], [smoothscroll="true"], [flex="1"]) {
    padding-inline-start: 12px !important;
    margin-inline-start: -12px !important;
    padding-inline-end: 12px !important;
    margin-inline-end: -12px !important;
  }
  
  #scrollbutton-up {
    z-index: 999 !important;
  }

  #scrollbutton-down {
    z-index: 999 !important;
  }

  spacer:is([part="overflow-start-indicator"]) {
    margin-inline: 0px 6px !important;
  }

  spacer:is([part="overflow-end-indicator"]) {
    margin-inline: 6px 0px !important;
  }



  #tabs-newtab-button,
  #new-tab-button {
    &:not([disabled]):hover
      > :is(.toolbarbutton-icon, .toolbarbutton-badge-stack) {
      background-color: var(--md-tab-background-color-hover) !important;
    }
  }

  #identity-icon-box {
    min-width: 24px !important;
    @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
    outline: 1px solid var(--md-menu-border-color) !important;
    }
  }




.tab-icon-image {
  fill: var(--md-icon-color-primary) !important;
}

@media not (-moz-pref("userChrome.ui-chrome-refresh")) {

    /* Default: rounded top corners */
  #nav-bar {
    border-radius: 8px 8px 0 0 !important;
  }

  /* Square top-left when first non-pinned tab (in arrowscrollbox) is selected
     but only when there are no pinned tabs present. If pinned tabs exist,
     prefer the pinned-tab rules. */
  #navigator-toolbox:not(:has(#pinned-tabs-container > .tabbrowser-tab)):has(#tabbrowser-arrowscrollbox > .tabbrowser-tab[selected="true"]:first-child) #nav-bar {
    border-radius: 0px 8px 0 0 !important;
  }

  /* Also square top-left when the first pinned tab is selected (pinned tabs
     may live in `#pinned-tabs-container`). */
  #navigator-toolbox:has(#pinned-tabs-container > .tabbrowser-tab[selected="true"]:first-child) #nav-bar {
    border-radius: 0px 8px 0 0 !important;
  }

  /* Hover rules: pinned-first hover always applies; arrowscrollbox-first hover
     applies only when there are no pinned tabs. We split into two rules so
     pinned tabs take precedence. */
  #navigator-toolbox:has(#pinned-tabs-container > .tabbrowser-tab:first-child:hover,
                         #pinned-tabs-container > .tabbrowser-tab:first-child :is(:hover)) #nav-bar {
    border-radius: 0px 8px 0 0 !important;
  }

  #navigator-toolbox:not(:has(#pinned-tabs-container > .tabbrowser-tab)):has(
    #tabbrowser-arrowscrollbox > .tabbrowser-tab:first-child:hover,
    #tabbrowser-arrowscrollbox > .tabbrowser-tab:first-child :is(:hover)
  ) #nav-bar {
    border-radius: 0px 8px 0 0 !important;
  }
    #tabbrowser-arrowscrollbox .tabbrowser-tab:is(:first-child) {
      margin-left: 10px !important;
    }

    /* Default: rounded top corners
    #nav-bar {
      border-radius: 8px 8px 0px 0px !important;
    }

    /* Square top-left when first non-pinned tab (in arrowscrollbox) is selected
    #navigator-toolbox:has(#tabbrowser-arrowscrollbox > .tabbrowser-tab[selected="true"]:first-child) #nav-bar {
      border-radius: 0px 8px 0px 0px !important;
    } 

      /* Arrowpanel Menu Border size
  *[part="content"] {
    border-width: 1px !important;
  }
  */

  #tabs-newtab-button, #new-tab-button {
    list-style-image: url("plus.svg") !important;
  }

    #tabs-newtab-button,
    #new-tab-button {
  & > :is(.toolbarbutton-icon, .toolbarbutton-badge-stack) {
    width: calc(var(--tab-min-height) - 7px) !important;
    height: calc(var(--tab-min-height) - 7px) !important;
    padding: 8px !important;
    margin-inline-start: 3px !important;
    margin-top: 1px !important;
    box-shadow: unset !important;
    }
  }

  #tabs-newtab-button, #new-tab-button{
    --toolbarbutton-border-radius: 6px !important;
  }
  

    .tab-content {
      padding: 0 10px !important;
    }

    #alltabs-button .toolbarbutton-badge-stack {
      transform: translate(0px, 1px) !important;
    }

    #alltabs-button {
      margin: 0 !important;
      margin-top: 2px !important;
      margin-left: 0px !important;
      width: calc(var(--tab-min-height) - 6px) !important;
      height: calc(var(--tab-min-height) - 6px) !important;

      box-shadow: unset !important;
      filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.50));
    
      justify-content: center !important;
      align-content: center !important;
      
      .toolbarbutton-badge-stack {
        background-color: color-mix(in srgb, var(--md-background-color-100) 13%, var(--md-accent-color)) !important;
    
        @media (prefers-color-scheme: dark) {
          background-color: var(--md-background-color-100) !important;
        }
      }
    
    
      &:not(:active, [open="true"]):hover {
        .toolbarbutton-badge-stack {
          background-color: var(--md-tab-background-color-hover) !important;
          box-shadow: unset !important;
          filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.50));
          outline-offset: -1px !important;
          outline: 1px solid var(--md-menu-background-color-hover) !important;
        }
      }
    
    
      &:active:hover,
      &[open="true"] {
        .toolbarbutton-badge-stack {
          background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
          box-shadow: unset !important;
          filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.50));
          outline-offset: -1px !important;
          outline: 1px solid var(--md-menu-background-color-hover) !important;
    
          @media (prefers-color-scheme: dark) {
            background-color: get-var(alltabs-background-color-open) !important;
          }
        }
      }
    
    
    :root:-moz-window-inactive #navigator-toolbox {
      #alltabs-button .toolbarbutton-badge-stack {
        background-color: var(--md-background-color-100) !important;
      }
    }
    
      .toolbarbutton-badge-stack {
        transform: translate(0px, 1px) !important;
    
        min-width: 28px !important;
        max-width: 28px !important;
        min-height: 28px !important;
        max-height: 28px !important;
    
        display: grid !important;
        align-content: center !important;
        place-content: center !important;
        place-items: center !important;
        justify-content: center !important;
    
        overflow: hidden !important;
        border-radius: 10px !important;
        outline-offset: -1px !important;
        outline: 1px solid var(--md-menu-border-color) !important;
      }
    
      .toolbarbutton-icon {
        fill: var(--md-accent-color) !important;
        filter: drop-shadow(0 0 1px var(--md-accent-color)) drop-shadow(0 0 2px var(--md-selection-background-color)) !important;
        width: 14px !important;
        height: 14px !important;
      }
    }

    #tabbrowser-tabs:not([overflow]) ~ #alltabs-button {
      display: none !important;
      margin-left: 0px !important;
  }
  
    #identity-box {
      padding-bottom: 2px !important;
      padding-top: 2px !important;
      margin-inline-end: 4px !important;
      margin-inline-start: 3px !important;

      @media not (-moz-pref("userChrome.ui-force-old-icons")) {
        fill: var(--md-icon-color-primary) !important;
      }
    }

  

    #identity-box:not(.chromeUI) {
      #identity-icon-box.identity-box-button {
        padding-inline: unset !important;
      }
    }
  

    :is(#identity-icon-box, #identity-permission-box).identity-box-button,
    #notification-popup-box,
    #urlbar-go-button,
    .search-go-button {

      max-height: 24px !important;
    }
  
    #identity-box {
      align-items: center !important;
    }
  

    #identity-permission-box.identity-box-button {
      padding-inline: 4px !important;
    }
  
    #identity-icon-box {
      background-color: var(--md-background-color-100) !important;
    }
  
    #identity-box[pageproxystate="valid"].notSecureText > .identity-box-button,
    #identity-box[pageproxystate="valid"].chromeUI > .identity-box-button,
    #identity-box[pageproxystate="valid"].extensionPage > .identity-box-button,
    #urlbar-label-box {
      background-color: var(--md-background-color-100) !important;
    }
  }

  .tab-audio-button {
    #tabbrowser-tabs:is([orient="vertical"][expanded], [orient="horizontal"]) &:not([pinned]):not([crashed]) {
      &[soundplaying]::part(button) {
        display: none !important;
      }
    }
  }

  .tab-audio-button {
        display: none !important;
  }

  :is(.all-tabs-secondary-button, .tab-icon-overlay)[soundplaying],
  .tab-icon-sound {
    -moz-context-properties: fill, fill-opacity !important;
    list-style-image: url("icons/audio.svg") !important;
    fill-opacity: 1 !important;
    fill: var(--md-text-primary) !important;
    background-color: transparent !important;
    border: 0px !important;
  }

  .all-tabs-secondary-button,
  .tab-icon-overlay,
  .tab-icon-sound {
    &[muted] {
      -moz-context-properties: fill, fill-opacity !important;
      list-style-image: url("icons/audio-muted.svg")  !important;
      fill-opacity: 1 !important;
      fill: var(--md-text-secondary) !important;
      border: 0px !important;
      background-color: transparent !important;
    }
  }

  .all-tabs-secondary-button,
  .tab-icon-overlay,
  .tab-icon-sound {
    &[activemedia-blocked] {
      -moz-context-properties: fill, fill-opacity !important;
      list-style-image: url("icons/audio-muted.svg")  !important;
      fill-opacity: 1 !important;
      fill: var(--md-text-secondary) !important;
      border: 0px !important;
      background-color: transparent !important;
    }
  }

  /* Zoom Button Font Fix */
#urlbar-zoom-button {
  outline-offset: var(--toolbarbutton-outline-offset) !important;
  outline: 1px solid var(--md-menu-border-color) !important;
  margin-inline: 5px !important;
  
  /* Force the font on the button itself */
  font-family: "Inter" !important;
  font-size: 12px !important;
  font-weight: 600 !important;
}

/* TARGET THE INTERNAL LABEL: This is usually what resists the font change */
#urlbar-zoom-button .toolbarbutton-text {
  font-family: inherit !important; /* Forces it to use the "Inter" from the parent */
  font-size: inherit !important;   /* Forces it to use the "9px" from the parent */
  font-weight: inherit !important; 
}

#urlbar-zoom-button:hover {
  outline: 1px solid var(--md-menu-background-color-hover) !important;
}


/* Fade in the minimize/maximize/close buttons */
.titlebar-button:hover {
  transition: background-color 0.18s ease !important;
}

.titlebar-button {
  color: var(--md-text-primary) !important;
}

.titlebar-min:hover, .titlebar-max:hover, .titlebar-restore:hover {
  background-color: var(--md-menu-background-color-hover) !important;
  filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.4)) !important;
}

.titlebar-close:hover {
  filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.4)) !important;
  background-color: #E81123 !important;
}

.titlebar-min:active, .titlebar-max:active, .titlebar-restore:active {
  background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
}

.titlebar-close:active {
  background-color: color-mix(in srgb, #E81123 65%, transparent) !important;
}

/* 2. Specific Override for Titlebar Glyph Icons */
/* We target the icon and the internal stack to force the font change */
.titlebar-button > .toolbarbutton-icon,
.titlebar-button > .toolbarbutton-badge-stack {
  font-family: "Segoe Fluent Icons", "Segoe MDL2 Assets" !important;
  font-weight: normal !important; /* Icons break if forced to Aptos's 400 weight */
  font-size: unset !important;
}

#identity-icon-label {
  font-size: 13px !important;
}



/*.urlbarView {
	background-image: url("noise-512x512.png") !important;
	background-color: #2A2A2AC0 !important;
	backdrop-filter: blur(32px) !important;
} */



.bookmark-item[container],
treechildren::-moz-tree-image(title, container),
treechildren::-moz-tree-image(title, open) {
  list-style-image: url("folder.svg") !important;
}

.downloadIconShow .button-icon,
.folder-icon {
  list-style-image: url("folder.svg") !important;
}

#BMB_bookmarksPopup #BMB_viewBookmarksSidebar:not(.menuitem-iconic) {
  padding: 13px !important;
  padding-left: 33px !important;
}

#BMB_bookmarksPopup #BMB_searchBookmarks:not(.menuitem-iconic) {
  padding: 13px !important;
  padding-left: 33px !important;
}

#BMB_bookmarksPopup #BMB_bookmarksShowAllTop:not(.menuitem-iconic) {
  padding: 13px !important;
  padding-left: 33px !important;
}

/* 1. Sidebar & Library (Tree-based) - No changes here */
:is(#bookmarks-view, #historyTree, #editBMPanel_folderTree, #placesList, #placeContent) 
treechildren::-moz-tree-image(title, container, open) {
  list-style-image: url("folder-open.svg") !important;
  -moz-context-properties: fill !important;
  fill: var(--md-accent-color) !important;
}

/* 2. Toolbar & Menu Folders - STRICT Selector */
/* The '>' symbol prevents this from affecting items INSIDE the folder */
:is(#PlacesToolbar, #BMB_bookmarksPopup, #bookmarksMenu) 
.bookmark-item[container][open] > :is(.menu-icon, .toolbarbutton-icon) {
  list-style-image: url("folder-open.svg") !important;
  content: url("folder-open.svg") !important;
  -moz-context-properties: fill !important;
  fill: var(--md-accent-color) !important;
}


tree {
  color: var(--md-text-primary) !important;
  background-color: var(--md-menu-background-color) !important;
  border-top: var(--md-menu-border-size) !important;
  border-color: var(--md-menu-border-color) !important;
}

#editBMPanel_folderTree > placesTree {
  border: 1px solid red !important;
}

#editBMPanel_newFolderButton {
  border: var(--md-menu-border-size) var(--md-menu-border-color) !important;
}

#editBMPanel_newFolderButton:hover {
  background-color: var(--md-menu-background-color-hover) !important;
}

#editBMPanel_newFolderButton:active {
  background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
  border: var(--md-menu-border-size) var(--md-accent-color) !important;
}


#unified-extensions-view > .unified-extensions-item-menu-button.subviewbutton:hover {
  border-radius: 100px !important;
}

.unified-extensions-item-icon,
.unified-extensions-item
  .webextension-browser-action.subviewbutton
  > .toolbarbutton-badge-stack
  > .toolbarbutton-icon {
  height: 20px !important;
  width: 20px !important;
}

#identity-box:not(.chromeUI):not(.extensionPage) {
  #identity-icon-box.identity-box-button {
    padding-inline: unset !important;
  }
}

#identity-box[pageproxystate="valid"]:is(.extensionPage, .notSecure, .notSecureText, .mixedActiveContent, .httpsOnlyErrorPage, .weakCipher, .mixedDisplayContent, .mixedDisplayContentLoadedActiveBlocked, .certUserOverridden, #identity-box[pageproxystate="valid"].certErrorPage) #identity-icon-box.identity-box-button {
    padding-inline: 6px !important;
}

spacer[part="overflow-start-indicator"], spacer[part="overflow-end-indicator"] {
  border-color: var(--md-accent-color) !important;
  filter: drop-shadow(0 0 2px var(--md-accent-color)) drop-shadow(0 0 1px var(--md-selection-background-color)) !important;
  border-bottom: none !important;
}

#tabbrowser-tabs {
  min-height: unset !important;
}

.tab-close-button,
.messageCloseButton>.toolbarbutton-icon {
  height: 19px !important;
  @media (-moz-pref("userChrome.ui-chrome-refresh")) {
    padding: 4px !important;
  }
  @media not (-moz-pref("userChrome.ui-chrome-refresh")) {
    padding: 3px !important;
  }
  &:hover {
    outline-offset: -1px !important;
    outline: 1px solid var(--md-menu-background-color-hover) !important;
    filter: drop-shadow(0 0 3px rgba(0, 0, 0, 0.65)) !important;
  }
}

.tabbrowser-tab:not([pinned]) {
  .tab-close-button {
    display: flex !important;
  }
}

@media (-moz-pref("userChrome.ui-chrome-refresh")) {
  .tabbrowser-tab[pinned] {
    max-width: 46px !important;
    min-width: 46px !important;
  }
}

@media not (-moz-pref("userChrome.ui-chrome-refresh")) {
  .tabbrowser-tab[pinned] {
    max-width: 52px !important;
    min-width: 52px !important;
  }
}

.tabbrowser-tab[pinned] .tab-content {
  padding: 0 13px !important;
}

#tracking-protection-icon-container {
  margin-top: -1px !important;
}

/*.urlbar-page-action {
  width: calc(var(--urlbar-height) - var(--urlbar-container-padding)*2) !important;
} */


@media not (-moz-pref("userChrome.ui-chrome-refresh")) {

#tabs-newtab-button:is(:active:hover, [checked], [open]):not([disabled])
> :is(.toolbarbutton-icon, .toolbarbutton-badge-stack),
#new-tab-button:is(:active:hover, [checked], [open]):not([disabled])
> :is(.toolbarbutton-icon, .toolbarbutton-badge-stack) {
  --md-circle-size: 0% !important;
  background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
}

  .tab-background {
    border-radius: 8px 8px 0 0 !important;

    &::before {
      border-bottom-right-radius: 8px !important;
    }

    &::after {
      border-bottom-left-radius: 8px !important;
    }
  }
}
/*
#downloads-indicator-progress-inner {
  --toolbarbutton-icon-fill-attention: red !important;
}
*/

#downloadsListBox > richlistitem[selected] {
  background-color: var(--md-selection-background-color) !important;
  .downloadProgress::-moz-progress-bar {
    --download-progress-fill-color: color-mix(in srgb, var(--md-background-color-0) 60%, var(--md-accent-color)) !important;
  }
}

.textbox-search-sign, .textbox-search-icon {
  list-style-image: url("chrome://global/skin/icons/search-glass.svg") !important;
  fill: var(--md-accent-color) !important;
  -moz-context-properties: fill, fill-opacity !important;
  fill-opacity: 1 !important;
  filter: drop-shadow(0 0 2px var(--md-accent-color)) drop-shadow(0 0 1px var(--md-selection-background-color)) !important;
}

[dir="ltr"] .toolbar-menupopup :is(menu, menuitem).bookmark-item {
  padding-left: 9px !important;
  padding-right: 0px !important;
  padding-top: 14px !important;
  padding-bottom: 14px !important;
}

[dir="ltr"] .toolbar-menupopup :is(menu, menuitem).openintabs-menuitem {
  padding-left: 33px !important;
  padding-right: 0px !important;
  padding-top: 14px !important;
  padding-bottom: 14px !important;
}

toolbarseparator {
  padding-block: 0px !important;
}

.panel-header {
  & > h1 > span {
    padding-block: 4px !important;
    /* This creates the 360-degree fade from center to edges */
    background: radial-gradient(circle, var(--md-menu-border-color) 0%, var(--md-background-color-0) 100%) !important;
    display: inline-block; /* Ensures padding and background render correctly */
    width: 100%; /* Optional: ensures the gradient spans the full width */
    font-size: 1.1em !important;
  }
}

.panel-info-button {
  & > image {
    fill: var(--md-accent-color) !important;
  }
}

.panel-info-button {
  /* Hover, Active (click), and Selected (open/toggled) */
  &:hover,
  &:active,
  &[selected="true"],
  &[open],
  &[checked] {
    border-radius: 100px !important;
  }
}

panel toolbarseparator {
  padding: 0px !important;
}

#downloadsFooterButtons > toolbarseparator {
  margin: 0px !important;
  padding-block: 4px !important;
}

#widget-overflow-mainView > toolbarseparator, #widget-overflow-mainView > .panel-subview-body > toolbarseparator, .PanelUI-subView toolbarseparator, #unified-extensions-panel toolbarseparator, #permission-popup-mainView > toolbarseparator, #editBookmarkPanel toolbarseparator, .cui-widget-panel toolbarseparator {
  margin: 4px 4px !important;
}

#PlacesToolbarItems>toolbarseparator {
  padding-inline: 1px !important;
  border-left: 1px solid var(--md-accent-color) !important;
  filter: drop-shadow(0 0 2px var(--md-accent-color)) drop-shadow(0 0 1px var(--md-selection-background-color)) !important;
  margin-left: 4px !important;
  margin-right: 1px !important;
  &::before {
      margin-block: 8px 10px !important;
  }
}

.tab-stack::before {
  opacity: 0 !important;
 }
 
#unified-extensions-button > image {
  transform: scale(1.16) !important;
}

.translations-panel-header {
  margin-left: 16px !important;
}

@media not (-moz-pref("userChrome.ui-chrome-refresh")) {
  #pinned-tabs-container {
    margin-left: 10px !important;
    margin-right: -10px !important;
  }
}

@media (-moz-pref("userChrome.ui-chrome-refresh")) {
  #pinned-tabs-container {
    margin-left: 6px !important;
    margin-right: -6px !important;
  }
}

/* Rounded Corners like Edge */
@media (-moz-pref("userChrome.ui-rounded-corners")) {
  /* Since Firefox 120, when the bookmarks bar is set to only open on new tabs,
   * the bookmarks bar overlaps the #browser element. */

  /* Change the element that shifts the browser content to the correct position. */
  #main-window[BookmarksToolbarOverlapsBrowser] .newTabBrowserPanel,
  #main-window[BookmarksToolbarOverlapsBrowser] #sidebar-box {
    padding-top: 0 !important;
    margin-top: 0 !important;
  }

  #main-window[BookmarksToolbarOverlapsBrowser] #browser {
    margin-top: var(--bookmarks-toolbar-overlapping-browser-height);
  }

  /* Make sure that the toolbars are not positioned in-front of the browser
   * element. */
  #main-window[BookmarksToolbarOverlapsBrowser] #navigator-toolbox:not([style*="z-index"]) {
    z-index: auto !important;
  }

  /* Move the browser element in-front of the toolbars when on the new tab page. */
  #main-window:not([BookmarksToolbarOverlapsBrowser]) #browser {
    z-index: 1 !important;
  }

  /*
    MARK: Rc Variables
  */
  #main-window:not([chromehidden~="toolbar"]) {
    --uc-tweak-rounded-corners-padding: 4px;
    --uc-tweak-rounded-corners-radius: 7px;
    --uc-tweak-rounded-corners-shadow:
      0 -.8px 0 0 rgb(0 0 0 / 0.01),
      0 0.5px 1px 1px rgb(0 0 0 / 0.01),
      0 1px 1px rgb(0 0 0 / 0.01);
    --browser-frame-bgcolor: var(--toolbar-bgcolor, var(--lwt-accent-color));

    /* Different shadow for higher resolution displays. */
    @media (resolution > 1.8dppx) {
      --uc-tweak-rounded-corners-shadow:
        0 0 0.5px 0.5px rgb(0 0 0 / 0.06),
        0 0.5px 1.5px rgb(0 0 0 / 0.1);
    }

  }

  /* Hide border below titlebar on macOS, as its titlebar already has a border. */


  /* Remove separator between toolbars and the browser window. */
  #navigator-toolbox {
    border-bottom: none !important;
  }

  /* Disable rounded corners in fullscreen, only if the toolbar is hidden. */
  :root[inFullscreen] #navigator-toolbox[style*="margin-top"] + #browser,
  :root[inDOMFullscreen] #browser {
    --uc-tweak-rounded-corners-padding: 0;
    --uc-tweak-rounded-corners-radius: 0;
    --uc-tweak-rounded-corners-shadow: unset;
  }

  /*
    MARK: Rc Browser
  */
  
  #tabbrowser-tabbox .browserStack {
    
    /* 0. BASE / STANDARD VERSION (Default State)
       This applies when neither Flush nor Top-Only is enabled. 
       It creates the "Floating" look with a border all the way around. */
    margin-inline: var(--uc-tweak-rounded-corners-padding) !important;
    margin-block-end: var(--uc-tweak-rounded-corners-padding) !important;
    border-radius: var(--uc-tweak-rounded-corners-radius) !important;

    /* 1. FLUSH SCROLLBAR OVERRIDE
       Only changes the right margin to 0. */
    @media (-moz-pref("userChrome.ui-rounded-corners-flush-scrollbar")) {
      margin-inline-end: 0 !important;
    }

    /* 2. TOP CORNERS ONLY OVERRIDE
       Removes the side/bottom margins and the bottom rounding. */
    @media (-moz-pref("userChrome.ui-rounded-top-corners")) {
      margin-inline: 0 !important;
      margin-block-end: 0 !important;
      border-bottom-left-radius: 0 !important;
      border-bottom-right-radius: 0 !important;
    }

    /* Shared properties for all versions */
    box-shadow: var(--uc-tweak-rounded-corners-shadow) !important;
    background-color: var(--tabpanel-background-color) !important;
    position: relative !important;

    /* The "Edge" frame effect */
    &::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit; /* Takes the radius from the overrides above */
      box-shadow:
        var(--uc-tweak-rounded-corners-shadow, 0 0 transparent),
        0 0 0 16px var(--browser-frame-bgcolor) !important;
      clip-path: inset(0);
      pointer-events: none;
    }
  }

  /* Prevent status panel corners and shadow from appearing outside the browser. */
  #statuspanel {
    overflow: hidden;
  }

  /*
    MARK: Rc Sidebar
  */
  #sidebar-box {
    margin-inline-start: var(--uc-tweak-rounded-corners-padding) !important;
    margin-block-end: var(--uc-tweak-rounded-corners-padding) !important;
    border-radius: var(--uc-tweak-rounded-corners-radius) !important;
    overflow: hidden !important;
    box-shadow: var(--uc-tweak-rounded-corners-shadow) !important;

    &[positionend] {
      margin-inline-start: 0 !important;
      margin-inline-end: var(--uc-tweak-rounded-corners-padding) !important;
    }
  }

  /*
    MARK: Rc Devtools
  */

  /* Devtools window when docked to the left or right. */
  .devtools-toolbox-side-iframe {
    margin-block-end: var(--uc-tweak-rounded-corners-padding) !important;
    border-radius: var(--uc-tweak-rounded-corners-radius) !important;
    overflow: hidden !important;
    box-shadow: var(--uc-tweak-rounded-corners-shadow) !important;

    /* Devtools window when docked to the left. */
    &:first-child {
      margin-inline-start: var(--uc-tweak-rounded-corners-padding) !important;
    }

    /* Devtools window when docked to the right. */
    &:last-child {
      margin-inline-end: var(--uc-tweak-rounded-corners-padding) !important;
    }
  }

  /* Devtools window when docked to the bottom. */
  .devtools-toolbox-bottom-iframe {
    margin: var(--uc-tweak-rounded-corners-padding) !important;
    margin-block-start: 0 !important;
    border-radius: var(--uc-tweak-rounded-corners-radius) !important;
    overflow: hidden !important;
    box-shadow: var(--uc-tweak-rounded-corners-shadow) !important;
  }

  /* Hide devtools splitter. */
  .devtools-side-splitter,
  .devtools-horizontal-splitter {
    background-color: transparent !important;
  }

  /* Responsive design mode. */
  .browserContainer {
	outline: none !important;
	box-shadow: none !important;
	@media -moz-pref("sidebar.revamp") {
		& {
			outline: none !important;
			box-shadow: none !important;
		}
	}
}
  .browserContainer {
  background: var(--md-background-color-100) !important;
}

  .browserContainer.responsive-mode {
    background-color: transparent !important;

    & .rdm-toolbar {
      margin-inline: var(--uc-tweak-rounded-corners-padding) !important;
      border-top-left-radius: var(--uc-tweak-rounded-corners-radius) !important;
      border-top-right-radius: var(--uc-tweak-rounded-corners-radius) !important;
      width: calc(100% - var(--uc-tweak-rounded-corners-padding) * 2) !important;
    }
  }

  /* Remove sidebar border when not in full screen. */
  :not(:root[inFullscreen] #navigator-toolbox[style*="margin-top"]) + #browser #sidebar-splitter {
    border-inline-width: 0 !important;
  }

  /* Apply colour to the frame around the browser window. */
  #browser {
    background-color: var(--browser-frame-bgcolor) !important;
  }

  /* Change colour of page when loading */
  #tabbrowser-tabpanels {
    background-color: transparent !important;
  }
}

.sidebar-splitter {
  --splitter-width: 0px !important;
  background-color: var(--md-content-separator-color) !important;
}

.urlbarView-url {
  font-size: unset !important;
}


  #tabs-newtab-button,
  #new-tab-button {
& > :is(.toolbarbutton-icon, .toolbarbutton-badge-stack) {
  box-shadow: unset !important;
  filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.40)) !important;
  fill: var(--md-text-primary) !important;
  }
}
/* Decrease the "pill" circle size specifically for Chrome Refresh */
@media (-moz-pref("userChrome.ui-chrome-refresh")) {
  
  /* 1. Target the internal stack where the circle background is often applied */
  #tabs-newtab-button .toolbarbutton-badge-stack,
  #TabsToolbar #new-tab-button .toolbarbutton-badge-stack {
    padding: 0 !important;
    margin: 0 !important;
    min-width: 28px !important; /* Chrome's exact pill size */
    min-height: 28px !important;
    max-width: 28px !important;
    max-height: 28px !important;
    border-radius: 50% !important;
  }

  /* 2. Target the icon to ensure it doesn't expand the circle */
  #tabs-newtab-button .toolbarbutton-icon,
  #TabsToolbar #new-tab-button .toolbarbutton-icon {
    width: 28px !important;
    height: 28px !important;
    padding: 7px !important; /* This controls the size of the '+' sign inside the circle */
    background: none !important; /* Prevents double-circles if background is on icon */
  }

  /* 3. Adjust the button container to remove the extra 2px padding you mentioned */
  #tabs-newtab-button, 
  #TabsToolbar #new-tab-button {
    padding-inline: 0px !important;
    margin-inline-start: -3px !important; /* Reverts the -2px on line 85 for this mode */
  }
}

/* 1. Prevent global dimming on the Tabs Toolbar */
:root:-moz-window-inactive #TabsToolbar {
  opacity: 1 !important;
}

/* 2. Group all elements that should be dimmed (0.75 opacity) */
:root:-moz-window-inactive #TabsToolbar .tabbrowser-tab:not([selected]),
:root:-moz-window-inactive #TabsToolbar :is(#tabs-newtab-button, #new-tab-button, #alltabs-button),
:root:-moz-window-inactive .titlebar-buttonbox-container,
:root:-moz-window-inactive .tabbrowser-tab[selected] .tab-content {
  opacity: 0.80 !important;
}

:root:-moz-window-inactive #tabbrowser-tabs:not([noshadowfortests]) .tab-background:is([selected], [multiselected]) {
  filter: drop-shadow(0 0 3px rgba(0, 0, 0, 0.25)) !important;
}




/*
menuitem#context-copyimage .menu-text {
  display: none;
}
menuitem#context-copyimage::before {
  content: "Copy Image Address" !important;
}
*/

/*
button {
  -moz-appearance: none !important;   
  border: 2px solid !important;
  color: var(--md-text-primary) !important;
  border-radius: 4px !important;
  padding: 4px !important;
  background-color: var(--md-background-color-0) !important;
  border-color: var(--md-menu-border-color) !important;
}

button:hover {
  background-color: var(--md-menu-background-color-hover) !important;
}

button:active {
  background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
}
  */

/* --------------------------------------------- Downloads/History/Bookmarks Window ----------------------------------------------- */

  @-moz-document url(chrome://browser/content/places/places.xhtml) {

    /* Change colors here */
    :root { --background: var(--md-background-color-100); }
    :root { --odd-bg-row: var(--md-background-color-0); }
    :root { --textcolor: var(--md-tab-label-color); }
    :root { --iconcolor: var(--md-text-primary); }
    :root { --selected-iconcolor: var(--md-text-primary); }
    :root { --hover-iconcolor: var(--md-text-primary); }
    :root { --bordercolor: var(--md-menu-border-color); }
    :root { --hover-bg-row: var(--md-menu-background-color-hover); }
    :root { --hover-text-row: var(--md-tab-label-color); }
    :root { --selected-text-row: var(--md-text-primary); }
    :root { --organizer-hover-background: var(--md-menu-background-color-hover) !important; }
    :root { --default-focusring-width: 0px !important; }
    :root { --default-focusring: var(--default-focusring-width) solid !important; }
    :root { --organizer-color: var(--md-text-primary) !important;}
    :root { 
      --organizer-deemphasized-color: var(--md-text-secondary) !important;
      --toolbarbutton-icon-fill: red !important;
    }
    
    :root {--focus-outline-width: 6px !important; }
    :root {--focus-outline-color: var(--md-text-primary) !important; }
    :root {--focus-outline: var(--focus-outline-width) solid var(--focus-outline-color) !important; }

    .textbox-search-sign, .textbox-search-icon {
      list-style-image: url(chrome://global/skin/icons/search-glass.svg) !important;
      fill: var(--md-accent-color) !important;
      -moz-context-properties: fill, fill-opacity !important;
      fill-opacity: 1 !important;
      filter: drop-shadow(0 0 2px var(--md-accent-color)) drop-shadow(0 0 1px var(--md-selection-background-color)) !important;
    }

@media (-moz-platform: windows) {
  #placesContext :is(menuitem, menu):not([image], .menu-iconic, .menuitem-iconic) {
    padding-inline-start: 36px !important;
  }
      menupopup:has(menuitem[type="checkbox"][checked="true"]) menuitem:not([type="checkbox"]) {
      padding-inline-start: 12px !important;
    }
    
    /* When no checkboxes are checked - regular items use 36px */
    menupopup:has(menuitem[type="checkbox"]):not(:has(menuitem[type="checkbox"][checked="true"])) menuitem:not([type="checkbox"]) {
      padding-inline-start: 36px !important;
    }
    
    /* ALL unchecked checkboxes use 36px - force override */
    menupopup menuitem[type="checkbox"]:not([checked="true"]) {
      padding-inline-start: 12px !important;
    }
    
    /* ALL checked checkboxes use 12px */
    menupopup menuitem[type="checkbox"][checked="true"] {
      padding-inline-start: 12px !important;
    }
}



@media (-moz-platform: windows) {
  /* When no checkboxes are checked - no reserved space, use 36px for all */
  #downloadsContextMenu:not(:has(menuitem[type="checkbox"][checked="true"])) menuitem {
    padding-inline-start: 36px !important;
  }
  
  /* When any checkbox IS checked - reserved space exists, use 12px for regular items */
  #downloadsContextMenu:has(menuitem[type="checkbox"][checked="true"]) menuitem:not([type="checkbox"]) {
    padding-inline-start: 12px !important;
  }
  
  /* Unchecked checkboxes always use 36px */
  #downloadsContextMenu menuitem[type="checkbox"]:not([checked="true"]) {
    padding-inline-start: 36px !important;
  }
  
  /* Checked checkboxes always use 12px */
  #downloadsContextMenu menuitem[type="checkbox"][checked="true"] {
    padding-inline-start: 12px !important;
  }
}
   /* Correct context menu padding in Library Window */
    @media (-moz-platform: windows), (-moz-platform: linux) {
      #placesMenu > menu {
        padding-block: 8px !important;
        border-radius: 4px !important;
      }
    }
    @media (-moz-platform: windows), (-moz-platform: linux) {
      #placesMenu > menuitem {
        padding-block: 14px !important;
      }
    }

    /* Toolbar buttons */
    #placesMenu > menu {
      border: none !important;
    }
    
    /* Toolbar button hover */
    #placesMenu > menu:hover {
      -moz-appearance: none !important;
      background-color: var(--hover-bg-row) !important;
    }
    
    /* Toolbar button open */
    #placesMenu > menu[open] {
      -moz-appearance: none !important;
      background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
    }
    
    
    /* Link to filter generator I used for some icons on down, not mine. https://codepen.io/sosuke/pen/Pjoqqp */
    
    /* Library Background */
    window#places[title="Library"] {
      background-color: var(--md-background-color-0) !important;
    }
    
    /* Toolbar */
    #placesToolbar {
     background-color: var(--md-background-color-0) !important;
     border-bottom: 0px !important;
     padding: 2px !important;
     margin-left: 4px !important;
     margin-right: -2px !important;
    }
    
    /* Forward and Back Buttons Disabled */
    #placesToolbar > toolbarbutton[disabled] > .toolbarbutton-icon {
      fill: var(--md-text-secondary) !important;
    }
    
    /* Forward and Back Buttons */
    #placesToolbar > #back-button > .toolbarbutton-icon {
      list-style-image: url("Back.svg") !important;
      fill: var(--iconcolor) !important;
      padding: 3px !important;
    }

    #placesToolbar > #forward-button > .toolbarbutton-icon {
      list-style-image: url("Forward.svg") !important;
      fill: var(--iconcolor) !important;
      padding: 3px !important;
    }

    
    #placesToolbar > toolbarbutton:not([disabled]):active {
      background-color: var(--hover-bg-row) !important;
    }

    #placesToolbar > toolbarbutton:not([disabled]):hover:active {
      background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
    }
    
    /* Toolbar Text */
    #placesMenu > menu > .menubar-text {
      color: var(--textcolor) !important;
    }
    
    /* Toolbar Spacer
    #libraryToolbarSpacer {
      max-width: 20px !important;
      padding: 3px !important;
      margin-right: 15px !important;
      margin-left: 4px !important;
  }
    /*box-shadow: 0 0 1px var(--iconcolor) !important;*/ /* To see spacer */
    
    
    /* Toolbar Icons, Menupopup arrows & ckeckmarks (limegreen). Not The Forward or Back Buttons */
    #placesMenu menupopup .menu-right {
        color: rgb(174, 181, 190) !important;
    }
    
    /* Menu items disabled 
    #placesMenu menupopup menuitem[disabled] {
      color: var(--textcolor) !important;
      opacity: .32 !important;
    }*/
    
    /* Downloads Box */
    #downloadsListBox {
        background-color: var(--background) !important;
        color: var(--textcolor) !important;
        scrollbar-color: var(--md-menu-border-color) var(--md-menu-background-color) !important;
      }
      
      #downloadsListBox:hover {
        scrollbar-color: color-mix(in srgb, var(--md-menu-border-color) 90%, white) var(--md-menu-background-color) !important;
      }
      
      #downloadsListBox:active {
        scrollbar-color: color-mix(in srgb, var(--md-menu-border-color) 70%, white) var(--md-menu-background-color) !important;
      }

      #downloadsListBox:focus > richlistitem[selected] {
        color: var(--md-selection-text-color) !important;
        background-color: var(--md-selection-background-color) !important;
        border: 0px !important;
        outline: none !important;
        border-radius: 0px !important;
        background-image: none !important;
      }

      #downloadsListBox > richlistitem[selected] {
        .downloadProgress::-moz-progress-bar {
          background-color: color-mix(in srgb, var(--md-background-color-0) 60%, var(--md-accent-color)) !important;
        }
      }

        .downloadProgress::-moz-progress-bar {
          background-color: var(--md-accent-color) !important;
        }        


      richlistitem:hover {
        background-color: color-mix(in srgb, var(--md-background-color-50) 40%, transparent) !important;
      }
     /* 
      richlistitem[selected="true"] {
        color: white !important;
        background-color: var(--odd-bg-row) !important;
        border: 0px !important;
        outline: none !important;
      }
      
      richlistbox:focus > richlistitem[selected] {
        background-color: black !important;
        color: red !important;
        }
*/
        richlistitem[selected] {
          background-image: none !important;
          border: 0px !important;
          outline: none !important;
          border-radius: 0px !important;
      }
      
        #downloadsRichListBox > richlistitem[selected] {
          outline: 0px !important;
          outline-offset: 0px !important;
          -moz-outline-radius: 0 !important;
          border: 0px !important;
        }
      
      richlistbox {
        border: 0px !important;
        border-top: 1px solid var(--bordercolor) !important;
      }
      
      richlistbox > richlistitem[selected] {
        background-color: var(--md-selection-background-color) !important;
        color: var(--md-selection-text-color) !important;
      }
    
    /* All List Colors */
    #placesView,
    #placesView .scrollbox-innerbox,
    #infoPane, #placesList, #placeContent {
      -moz-appearance: none !important;
      background-color: var(--md-background-color-0) !important;
      color: var(--textcolor) !important;
    }
    #placeContent {
      border: 0px !important;
    }

    /* List Header */
    #placeContent treecol {
      -moz-appearance: none !important;
      background-color: var(--md-background-color-0) !important;
      padding: 3px !important;
      color: var(--textcolor) !important;
      border-top: 1px solid var(--bordercolor) !important;
      border-right: 0px !important;
      border-bottom: 0px !important;
    }
    treecol {
      border-inline-start: 1px solid var(--bordercolor) !important;
    }
    
    treecol:nth-child(1) {
      border-inline-start: 0px !important;
    }
 
    #contentView treecol {
      box-shadow: inset 0 -1px var(--bordercolor) !important;
    }
    /* List Header Hover */
    #placeContent treecol:hover {
      -moz-appearance: none !important;
      background-color: var(--hoverBGcolor) !important;
      color: var(--hover-text-row) !important;
    }
    
    /* Spitter */
    #placesView > splitter {
      border-inline-end: 1px solid var(--bordercolor) !important;
    }
    
/* Right side list border */
#placesList {
    border-top: 1px solid var(--bordercolor) !important;
  }
  
  /* Right side list text */


  #placeContent treechildren::-moz-tree-cell-text {
    padding-left: 6px !important;
  }
  #placeContent treechildren::-moz-tree-cell-text(hover) {
    color: var(--hover-text-row) !important;
  }
  #placeContent treechildren::-moz-tree-cell-text(selected) {
    color: var(--md-selection-text-color) !important;
  }
  #placeContent treechildren::-moz-tree-row {
    background-color: var(--background) !important
  }
  
  /* Odd rows background */
  #placeContent treechildren::-moz-tree-row(odd) {
    background-color: var(--odd-bg-row) !important;
  }
  
  /* Right side list background */
  #placesView treechildren::-moz-tree-row(hover) {
    background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
  }
  #placesView treechildren::-moz-tree-row(selected) {
    color: var(--md-selection-text-color) !important;
    background-color: var(--md-selection-background-color) !important;
  }
  
  /* Right side list Icons */
  #placesView treechildren::-moz-tree-image {
    fill-opacity: 1 !important;
    fill: var(--md-text-secondary) !important;
  }
  #placesView treechildren::-moz-tree-image(title hover) {
    fill-opacity: 1 !important;
    fill: var(--md-text-secondary) !important;
  }
  #placesView treechildren::-moz-tree-image(title selected) {
    fill-opacity: 1 !important;
    fill: var(--md-text-primary) !important;
  }
  /* Right side Folders */
  #placesView treechildren::-moz-tree-image(container selected) {
    fill-opacity: 1 !important;
    fill: var(--md-text-primary) !important;
  }
  
  /* Left side list Icons */
  #placesList treechildren::-moz-tree-image {
    padding-right: 4px !important;
    fill-opacity: 1 !important;
    fill: var(--md-text-secondary) !important;
  }
  /* Hover Left side Icons */
  #placesList treechildren::-moz-tree-image(title hover) {
    fill-opacity: 1 !important;
    fill: var(--md-text-secondary) !important;
  }
  /* Hover Left side Folders */
  #placesList treechildren::-moz-tree-image(container hover) {
    fill-opacity: 1 !important;
    fill: var(--md-text-secondary) !important;
  }
  /* Selected left side icons */
  #placesList treechildren::-moz-tree-image(title selected) {
    fill-opacity: 1 !important;
    fill: var(--md-accent-color) !important;
  }
  /* Selected Left side Folders */
  #placesList treechildren::-moz-tree-image(container selected) {
    fill-opacity: 1 !important;
    fill: var(--md-accent-color) !important;
  }
  
  /* Left Side Rows Hover */
  #placesList treechildren::-moz-tree-row(hover) {
    background-color: var(--hover-bg-row) !important;
  }
  /* Left Side Rows Selected */
  #placesList treechildren::-moz-tree-row(selected) {
    background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
  }
  /* Left Side Text Hover */
  #placesList treechildren::-moz-tree-cell-text(hover) {
    fill-opacity: 1 !important;
    color: var(--md-tab-label-color) !important;
  }
  /* Left Side Text Selected */
  #placesList treechildren::-moz-tree-cell-text(selected) {
    fill-opacity: 1 !important;
    color: var(--md-selection-text-color) !important;
  }
    



    /* Searchbox Focus */
    #searchFilter[focused] {
      background-color: var(--md-background-color-50) !important;
      color: var(--textcolor) !important;
    }
    /* Clear Text Icon (Not sure how to style this)
    .textbox-search-clear {
    }*/
    
    /* Clear Downloads Button */
    #clearDownloadsButton[disabled] {
      color: var(--md-text-secondary) !important;
      padding: 8px !important;
      opacity: 1 !important;
    } 
 
    #clearDownloadsButton {
      list-style-image: url("chrome://global/skin/icons/delete.svg") !important;
      color: var(--md-tab-label-color) !important;
      padding-left: 5px !important;
      padding-right: 7px !important;
      padding-top: 8px !important;
      padding-bottom: 8px !important;
    }
 
    #clearDownloadsButton > .toolbarbutton-icon {
      display: inline-flex !important;
      display: -moz-inline-box !important;
      margin-inline-end: 4px !important;
    }    
    
    /* Details */
    #detailsDeck {
      background-color: var(--background) !important;
      color: var(--textcolor) !important;
      border-top: 1px solid var(--bordercolor) !important;
    }
    
    /* Textbox, Field, Selector (some of this may change other places) */
    #infoBox textbox, 
    #infoBox listbox,
    #editBMPanel_namePicker,
    #editBMPanel_tagsField,
    #editBMPanel_tagsSelector,
    #editBMPanel_keywordField,
    #editBMPanel_locationField {
      -moz-appearance: none !important;
      border: var(--md-menu-border-size) !important;
      border-color: var(--bordercolor) !important;
      border-radius: 4px !important;
      background-color: var(--odd-bg-row) !important;
      color: var(--textcolor) !important;
    }
    
    /* Details button (limegreen)*/
    #detailsDeck button {
      -moz-appearance: none !important;
      filter: invert(56%) blue(80%) saturate(2591%) hue-rotate(81deg) brightness(118%) contrast(128%) !important;
    }
    
    #detailsPane {
      background-color: var(--md-background-color-100) !important;
      border-top: 1px solid var(--bordercolor) !important;
    }
    
    .expander-up, .expander-down {
      padding-left: 6px !important;
      padding-right: 6px !important;
      padding-top: 0px !important;
      padding-bottom: 0px !important;
      border: var(--md-menu-border-size) !important;
      border-color: var(--bordercolor) !important;
      border-radius: 4px !important;
      color: var(--iconcolor) !important;
      background-color: var(--md-background-color-0) !important;
    }
    
    .expander-up:hover, .expander-down:hover {
      -moz-appearance: none !important;
      background-color: var(--md-menu-background-color-hover) !important;
    }

    .expander-up:active, .expander-down:active {
      -moz-appearance: none !important;
      background-color: color-mix(in srgb, var(--md-menu-background-color-hover) 86%, white) !important;
    }

    .textbox-search-sign {
      margin-left: 3px !important;
    }
    
  }

  /* Target only windows where the toolbar is supposed to be hidden */
#main-window[chromehidden~="toolbar"] #nav-bar {
    display: none !important;
    visibility: collapse !important;
}